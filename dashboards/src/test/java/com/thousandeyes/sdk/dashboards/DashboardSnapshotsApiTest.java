/*
 * Dashboards API
 * Manage ThousandEyes Dashboards.
 *
 * 
 *
 * NOTE: This class is auto generated by OpenAPI Generator (https://openapi-generator.tech).
 * https://openapi-generator.tech
 * Do not edit the class manually.
 */


package com.thousandeyes.sdk.dashboards;

import com.thousandeyes.sdk.dashboards.model.ApiDashboardSnapshot;
import com.thousandeyes.sdk.dashboards.model.ApiWidgetDataSnapshotResponse;
import com.thousandeyes.sdk.dashboards.model.DashboardSnapshotResponse;
import com.thousandeyes.sdk.dashboards.model.DashboardSnapshotsPage;
import com.thousandeyes.sdk.dashboards.model.Error;
import com.thousandeyes.sdk.dashboards.model.GenerateDashboardSnapshotRequest;
import java.net.URI;
import com.thousandeyes.sdk.dashboards.model.UnauthorizedError;
import com.thousandeyes.sdk.dashboards.model.UpdateSnapshotExpirationDateApiRequest;
import com.thousandeyes.sdk.dashboards.model.ValidationError;
import static com.github.tomakehurst.wiremock.client.WireMock.*;
import static com.github.tomakehurst.wiremock.common.ContentTypes.AUTHORIZATION;
import static com.github.tomakehurst.wiremock.common.ContentTypes.CONTENT_TYPE;
import static com.thousandeyes.sdk.serialization.JSON.getDefault;
import static org.junit.jupiter.api.Assertions.assertEquals;
import static org.junit.jupiter.api.Assertions.assertNotNull;

import java.net.URLEncoder;
import java.nio.charset.StandardCharsets;

import org.junit.jupiter.api.BeforeAll;
import org.junit.jupiter.api.Test;

import com.fasterxml.jackson.core.JsonProcessingException;

import com.fasterxml.jackson.databind.DeserializationFeature;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.github.tomakehurst.wiremock.junit5.WireMockRuntimeInfo;
import com.github.tomakehurst.wiremock.junit5.WireMockTest;

import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;
import java.util.Set;

import com.thousandeyes.sdk.client.ApiClient;
import com.thousandeyes.sdk.client.ApiException;
import com.thousandeyes.sdk.client.NativeApiClient;


/**
 * Request and Response model deserialization tests for DashboardSnapshotsApi
 */
@WireMockTest
public class DashboardSnapshotsApiTest {
    private static final String TOKEN = "valid-token";
    private static final String BEARER_TOKEN = "Bearer %s".formatted(TOKEN);
    private static DashboardSnapshotsApi api;
    private final ObjectMapper mapper = getDefault()
            .getMapper()
            .configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES, true);

    @BeforeAll
    public static void setup(WireMockRuntimeInfo wireMockRuntimeInfo) {
        ApiClient client = NativeApiClient.builder()
                                .baseUri(wireMockRuntimeInfo.getHttpBaseUrl())
                                .bearerToken(TOKEN)
                                .build();
        api = new DashboardSnapshotsApi(client);
    }
    
    /**
     * Create dashboard snapshot
     * <p>
     * Creates a new dashboard snapshot within your account group. The &#x60;Edit Snapshots&#x60; permission is required to use this endpoint. 
     *
     * @throws JsonProcessingException if the deserialization fails
     */
    @Test
    public void createDashboardSnapshotRequestAndResponseDeserializationTest()
            throws JsonProcessingException, ApiException
    {

        var requestBodyJson = """
                {
                  "endDate" : "2023-05-16T10:14:28Z",
                  "dashboardId" : "646f4d2ce3c99b0536c3821e",
                  "displayName" : "snapshot from API",
                  "anonymizeData" : true,
                  "timezone" : "PST",
                  "startDate" : "2023-05-16T10:14:28Z",
                  "expirationDate" : "2023-05-16T10:14:28Z"
                }
                                 """;
        var requestBodyContentType = "application/json";
        GenerateDashboardSnapshotRequest mappedRequest = 
                mapper.readValue(requestBodyJson, GenerateDashboardSnapshotRequest.class);
        assertNotNull(mappedRequest);

        var responseBodyJson = """
                {
                  "snapshotId" : "d28bb71f-5a47-4783-8f12-d4b115e61b0c",
                  "_links" : {
                    "self" : {
                      "hreflang" : "hreflang",
                      "templated" : true,
                      "profile" : "profile",
                      "name" : "name",
                      "href" : "https://api.thousandeyes.com/v7/link/to/resource/id",
                      "type" : "type",
                      "deprecation" : "deprecation",
                      "title" : "title"
                    }
                  }
                }
                                  """;
        var statusCode = 201;
        var responseContentType = "application/json";
        DashboardSnapshotResponse mappedResponse = 
                mapper.readValue(responseBodyJson, DashboardSnapshotResponse.class);
        assertNotNull(mappedResponse);

        var path = "/dashboard-snapshots";
        stubFor(post(urlPathTemplate(path))
                        .withHeader(AUTHORIZATION, equalTo(BEARER_TOKEN))
                        .withHeader(CONTENT_TYPE, equalTo(requestBodyContentType))
                        .withRequestBody(equalToJson(requestBodyJson))
                        .willReturn(aResponse()
                                            .withHeader(CONTENT_TYPE, responseContentType)
                                            .withBody(responseBodyJson)
                                            .withStatus(statusCode)));

        var apiResponse = api.createDashboardSnapshot(mappedRequest, null);
        assertEquals(mappedResponse, apiResponse);
    }
    
    /**
     * Delete dashboard snapshot
     * <p>
     * Deletes a dashboard snapshot using the &#x60;snapshotId&#x60; provided in the request. Users with the &#x60;Edit reports for all users in account group&#x60; permission (Account Admin) can delete any dashboard snapshot. 
     *
     * @throws JsonProcessingException if the deserialization fails
     */
    @Test
    public void deleteDashboardSnapshotRequestAndResponseDeserializationTest()
            throws JsonProcessingException, ApiException
    {
        String snapshotId = "d28bb71f-5a47-4783-8f12-d4b115e61b0c";


        var statusCode = 204;

        var path = "/dashboard-snapshots/{snapshotId}";
        stubFor(delete(urlPathTemplate(path))
                        .withPathParam("snapshotId", equalTo(URLEncoder.encode(snapshotId, StandardCharsets.UTF_8)))
                        .withHeader(AUTHORIZATION, equalTo(BEARER_TOKEN))
                        .willReturn(aResponse()
                                            .withStatus(statusCode)));

        var apiResponse = api.deleteDashboardSnapshotWithHttpInfo(snapshotId, null);
        assertEquals(statusCode, apiResponse.getStatusCode());
    }
    
    /**
     * Retrieve dashboard snapshot
     * <p>
     * This operation returns a list of widgets configured in dashboard snapshot configured in ThousandEyes. Seed this endpoint with a snapshotId found from the /dashboard-snapshots endpoint. This endpoint requires the &#x60;View Snapshots&#x60; permission be assigned to the role of the user accessing this endpoint. Returns a list of widgets configured within a dashboard snapshot. Use the &#x60;snapshotId&#x60; obtained from the &#x60;/dashboard-snapshots&#x60; endpoint. The &#x60;View Snapshots&#x60; permission is required to use this endpoint.\&quot;
     *
     * @throws JsonProcessingException if the deserialization fails
     */
    @Test
    public void getDashboardSnapshotRequestAndResponseDeserializationTest()
            throws JsonProcessingException, ApiException
    {
        String snapshotId = "d28bb71f-5a47-4783-8f12-d4b115e61b0c";


        var responseBodyJson = """
                {
                  "snapshotId" : "d28bb71f-5a47-4783-8f12-d4b115e61b0c",
                  "_links" : {
                    "appLink" : {
                      "hreflang" : "hreflang",
                      "templated" : true,
                      "profile" : "profile",
                      "name" : "name",
                      "href" : "https://api.thousandeyes.com/v7/link/to/resource/id",
                      "type" : "type",
                      "deprecation" : "deprecation",
                      "title" : "title"
                    },
                    "self" : {
                      "hreflang" : "hreflang",
                      "templated" : true,
                      "profile" : "profile",
                      "name" : "name",
                      "href" : "https://api.thousandeyes.com/v7/link/to/resource/id",
                      "type" : "type",
                      "deprecation" : "deprecation",
                      "title" : "title"
                    }
                  },
                  "apiLinks" : [ {
                    "key" : ""
                  }, {
                    "key" : ""
                  } ],
                  "snapshotExpirationDate" : "2023-05-16T10:14:28Z",
                  "isScheduled" : true,
                  "widgets" : [ {
                    "embedUrl" : "https://embed.thousandeyes.com/e/00aa:3039802d-5c76-42d2-9a93-c6e5f9d3122f",
                    "shouldExcludeAlertSuppressionWindows" : true,
                    "_links" : {
                      "self" : {
                        "hreflang" : "hreflang",
                        "templated" : true,
                        "profile" : "profile",
                        "name" : "name",
                        "href" : "https://api.thousandeyes.com/v7/link/to/resource/id",
                        "type" : "type",
                        "deprecation" : "deprecation",
                        "title" : "title"
                      }
                    },
                    "visualMode" : "Full",
                    "filters" : {
                      "TEST" : [ 5187, 5227 ],
                      "ENDPOINT_MACHINE_ID" : [ "fbd0050c-07f7-43f7-9631-14b32f096962" ]
                    },
                    "title" : "Widget Title",
                    "type" : "Agent Status",
                    "metricGroup" : "BGP",
                    "measure" : {
                      "percentileValue" : 95.0,
                      "type" : "MEAN"
                    },
                    "apiLink" : "apiLink",
                    "metric" : "ENDPOINT_GATEWAY_CPU_LOAD_PERCENT",
                    "isEmbedded" : true,
                    "id" : "1234",
                    "fixedTimespan" : {
                      "unit" : "Days",
                      "value" : 10
                    },
                    "dataSource" : "ENDPOINT_AGENTS",
                    "direction" : "FROM_TARGET"
                  }, {
                    "embedUrl" : "https://embed.thousandeyes.com/e/00aa:3039802d-5c76-42d2-9a93-c6e5f9d3122f",
                    "shouldExcludeAlertSuppressionWindows" : true,
                    "_links" : {
                      "self" : {
                        "hreflang" : "hreflang",
                        "templated" : true,
                        "profile" : "profile",
                        "name" : "name",
                        "href" : "https://api.thousandeyes.com/v7/link/to/resource/id",
                        "type" : "type",
                        "deprecation" : "deprecation",
                        "title" : "title"
                      }
                    },
                    "visualMode" : "Full",
                    "filters" : {
                      "TEST" : [ 5187, 5227 ],
                      "ENDPOINT_MACHINE_ID" : [ "fbd0050c-07f7-43f7-9631-14b32f096962" ]
                    },
                    "title" : "Widget Title",
                    "type" : "Agent Status",
                    "metricGroup" : "BGP",
                    "measure" : {
                      "percentileValue" : 95.0,
                      "type" : "MEAN"
                    },
                    "apiLink" : "apiLink",
                    "metric" : "ENDPOINT_GATEWAY_CPU_LOAD_PERCENT",
                    "isEmbedded" : true,
                    "id" : "1234",
                    "fixedTimespan" : {
                      "unit" : "Days",
                      "value" : 10
                    },
                    "dataSource" : "ENDPOINT_AGENTS",
                    "direction" : "FROM_TARGET"
                  } ],
                  "accountId" : 1234,
                  "createdDate" : "2023-05-16 10:14:28",
                  "snapshotName" : "HTTP Server Dashboard Snapshot",
                  "timeSpan" : {
                    "duration" : 60,
                    "start" : "2023-05-16T10:14:28Z",
                    "startDate" : "2023-05-16 10:14:28"
                  },
                  "permalink" : "https://app.thousandeyes.com/dashboard/?snapshotId=d28bb71f-5a47-4783-8f12-d4b115e61b0c",
                  "aid" : "1234",
                  "snapshotCreatedDate" : "2023-05-16T10:14:28Z",
                  "isShared" : true,
                  "dashboard" : {
                    "isMigratedReport" : false,
                    "dashboardCreatedBy" : "1",
                    "_links" : {
                      "snapshots" : {
                        "hreflang" : "hreflang",
                        "templated" : true,
                        "profile" : "profile",
                        "name" : "name",
                        "href" : "https://api.thousandeyes.com/v7/link/to/resource/id",
                        "type" : "type",
                        "deprecation" : "deprecation",
                        "title" : "title"
                      },
                      "self" : {
                        "hreflang" : "hreflang",
                        "templated" : true,
                        "profile" : "profile",
                        "name" : "name",
                        "href" : "https://api.thousandeyes.com/v7/link/to/resource/id",
                        "type" : "type",
                        "deprecation" : "deprecation",
                        "title" : "title"
                      }
                    },
                    "dashboardModifiedBy" : "1",
                    "migratedReport" : false,
                    "isDefaultForAccount" : false,
                    "isDefaultForUser" : true,
                    "description" : "HTTP Server Widgets",
                    "isPrivate" : true,
                    "title" : "HTTP Server Widgets",
                    "isBuiltIn" : true,
                    "widgets" : [ {
                      "embedUrl" : "https://embed.thousandeyes.com/e/00aa:3039802d-5c76-42d2-9a93-c6e5f9d3122f",
                      "shouldExcludeAlertSuppressionWindows" : true,
                      "_links" : {
                        "self" : {
                          "hreflang" : "hreflang",
                          "templated" : true,
                          "profile" : "profile",
                          "name" : "name",
                          "href" : "https://api.thousandeyes.com/v7/link/to/resource/id",
                          "type" : "type",
                          "deprecation" : "deprecation",
                          "title" : "title"
                        }
                      },
                      "visualMode" : "Full",
                      "filters" : {
                        "TEST" : [ 5187, 5227 ],
                        "ENDPOINT_MACHINE_ID" : [ "fbd0050c-07f7-43f7-9631-14b32f096962" ]
                      },
                      "title" : "Widget Title",
                      "type" : "Agent Status",
                      "metricGroup" : "BGP",
                      "measure" : {
                        "percentileValue" : 95.0,
                        "type" : "MEAN"
                      },
                      "apiLink" : "apiLink",
                      "metric" : "ENDPOINT_GATEWAY_CPU_LOAD_PERCENT",
                      "isEmbedded" : true,
                      "id" : "1234",
                      "fixedTimespan" : {
                        "unit" : "Days",
                        "value" : 10
                      },
                      "dataSource" : "ENDPOINT_AGENTS",
                      "direction" : "FROM_TARGET"
                    }, {
                      "embedUrl" : "https://embed.thousandeyes.com/e/00aa:3039802d-5c76-42d2-9a93-c6e5f9d3122f",
                      "shouldExcludeAlertSuppressionWindows" : true,
                      "_links" : {
                        "self" : {
                          "hreflang" : "hreflang",
                          "templated" : true,
                          "profile" : "profile",
                          "name" : "name",
                          "href" : "https://api.thousandeyes.com/v7/link/to/resource/id",
                          "type" : "type",
                          "deprecation" : "deprecation",
                          "title" : "title"
                        }
                      },
                      "visualMode" : "Full",
                      "filters" : {
                        "TEST" : [ 5187, 5227 ],
                        "ENDPOINT_MACHINE_ID" : [ "fbd0050c-07f7-43f7-9631-14b32f096962" ]
                      },
                      "title" : "Widget Title",
                      "type" : "Agent Status",
                      "metricGroup" : "BGP",
                      "measure" : {
                        "percentileValue" : 95.0,
                        "type" : "MEAN"
                      },
                      "apiLink" : "apiLink",
                      "metric" : "ENDPOINT_GATEWAY_CPU_LOAD_PERCENT",
                      "isEmbedded" : true,
                      "id" : "1234",
                      "fixedTimespan" : {
                        "unit" : "Days",
                        "value" : 10
                      },
                      "dataSource" : "ENDPOINT_AGENTS",
                      "direction" : "FROM_TARGET"
                    } ],
                    "defaultTimespan" : {
                      "duration" : 7200,
                      "timespanDuration" : 7200,
                      "start" : "2023-05-16T10:14:28Z",
                      "end" : "2023-05-16T11:14:28Z",
                      "timespanStart" : "2023-05-16 10:14:28",
                      "timespanEnd" : "2023-05-16 11:14:28"
                    },
                    "globalFilterId" : "65babd9bb90bf55b17c96c8d",
                    "accountId" : 1234,
                    "apiLink" : [ {
                      "key" : ""
                    }, {
                      "key" : ""
                    } ],
                    "dashboardId" : "5e1f7a99143ae6004fdc3bb4",
                    "createdBy" : 1,
                    "globalOverride" : true,
                    "modifiedDate" : "2023-05-16 10:14:28",
                    "modifiedBy" : 1,
                    "isGlobalOverride" : true,
                    "aid" : "1234",
                    "dashboardModifiedDate" : "2023-05-16T10:14:28Z"
                  },
                  "expirationDate" : "2023-05-16 10:14:28"
                }
                                  """;
        var statusCode = 200;
        var responseContentType = "application/json";
        ApiDashboardSnapshot mappedResponse = 
                mapper.readValue(responseBodyJson, ApiDashboardSnapshot.class);
        assertNotNull(mappedResponse);

        var path = "/dashboard-snapshots/{snapshotId}";
        stubFor(get(urlPathTemplate(path))
                        .withPathParam("snapshotId", equalTo(URLEncoder.encode(snapshotId, StandardCharsets.UTF_8)))
                        .withHeader(AUTHORIZATION, equalTo(BEARER_TOKEN))
                        .willReturn(aResponse()
                                            .withHeader(CONTENT_TYPE, responseContentType)
                                            .withBody(responseBodyJson)
                                            .withStatus(statusCode)));

        var apiResponse = api.getDashboardSnapshot(snapshotId, null);
        assertEquals(mappedResponse, apiResponse);
    }
    
    /**
     * Retrieve dashboard snapshot data
     * <p>
     * Returns actual metrics used in the generation of a dashboard snapshot. 
     *
     * @throws JsonProcessingException if the deserialization fails
     */
    @Test
    public void getDashboardSnapshotWidgetDataRequestAndResponseDeserializationTest()
            throws JsonProcessingException, ApiException
    {
        String snapshotId = "d28bb71f-5a47-4783-8f12-d4b115e61b0c";
        String widgetId = "unpmg";


        var responseBodyJson = """
                {
                  "groupLabels" : [ {
                    "groupProperty" : "AGENT",
                    "groupLabels" : [ {
                      "groupId" : "2565",
                      "groupLabel" : "San Francisco, CA"
                    }, {
                      "groupId" : "2565",
                      "groupLabel" : "San Francisco, CA"
                    } ]
                  }, {
                    "groupProperty" : "AGENT",
                    "groupLabels" : [ {
                      "groupId" : "2565",
                      "groupLabel" : "San Francisco, CA"
                    }, {
                      "groupId" : "2565",
                      "groupLabel" : "San Francisco, CA"
                    } ]
                  } ],
                  "data" : {
                    "alerts" : [ {
                      "alertType" : "network-end-to-end-server",
                      "durationInSeconds" : 25,
                      "alertSource" : "Http Test",
                      "active" : true,
                      "testId" : "56512",
                      "startTime" : "2023-06-02T08:54:00Z",
                      "alertId" : "2004945",
                      "ruleId" : "281724",
                      "alertRule" : "Http Test Rule"
                    }, {
                      "alertType" : "network-end-to-end-server",
                      "durationInSeconds" : 25,
                      "alertSource" : "Http Test",
                      "active" : true,
                      "testId" : "56512",
                      "startTime" : "2023-06-02T08:54:00Z",
                      "alertId" : "2004945",
                      "ruleId" : "281724",
                      "alertRule" : "Http Test Rule"
                    } ],
                    "summary" : {
                      "offline" : 2,
                      "online" : 10,
                      "disabled" : 3
                    },
                    "totalAlerts" : 500,
                    "cards" : [ {
                      "numberOfDataPoints" : 24192,
                      "endDate" : "2023-05-16T10:14:28Z",
                      "cardId" : "lrxxr",
                      "alertSuppressionWindows" : [ {
                        "testIds" : [ "281474976710661" ],
                        "repeatUnit" : "week",
                        "durationInSeconds" : 7200,
                        "repeat" : "custom",
                        "name" : "Test dashboards",
                        "repeatEvery" : 5,
                        "id" : "281474976710662",
                        "startTimes" : [ "2023-05-16T10:14:28Z" ]
                      }, {
                        "testIds" : [ "281474976710661" ],
                        "repeatUnit" : "week",
                        "durationInSeconds" : 7200,
                        "repeat" : "custom",
                        "name" : "Test dashboards",
                        "repeatEvery" : 5,
                        "id" : "281474976710662",
                        "startTimes" : [ "2023-05-16T10:14:28Z" ]
                      } ],
                      "binSize" : 3600,
                      "previousValue" : 500.0,
                      "value" : 100.0,
                      "startDate" : "2023-05-16T10:14:28Z",
                      "timestamp" : 1567620000,
                      "status" : "No data"
                    }, {
                      "numberOfDataPoints" : 24192,
                      "endDate" : "2023-05-16T10:14:28Z",
                      "cardId" : "lrxxr",
                      "alertSuppressionWindows" : [ {
                        "testIds" : [ "281474976710661" ],
                        "repeatUnit" : "week",
                        "durationInSeconds" : 7200,
                        "repeat" : "custom",
                        "name" : "Test dashboards",
                        "repeatEvery" : 5,
                        "id" : "281474976710662",
                        "startTimes" : [ "2023-05-16T10:14:28Z" ]
                      }, {
                        "testIds" : [ "281474976710661" ],
                        "repeatUnit" : "week",
                        "durationInSeconds" : 7200,
                        "repeat" : "custom",
                        "name" : "Test dashboards",
                        "repeatEvery" : 5,
                        "id" : "281474976710662",
                        "startTimes" : [ "2023-05-16T10:14:28Z" ]
                      } ],
                      "binSize" : 3600,
                      "previousValue" : 500.0,
                      "value" : 100.0,
                      "startDate" : "2023-05-16T10:14:28Z",
                      "timestamp" : 1567620000,
                      "status" : "No data"
                    } ],
                    "tests" : [ {
                      "graphlets" : [ {
                        "metric" : "Availability",
                        "testId" : "68257",
                        "points" : [ {
                          "x" : 1580403900,
                          "y" : 128.249
                        }, {
                          "x" : 1580403900,
                          "y" : 128.249
                        } ]
                      }, {
                        "metric" : "Availability",
                        "testId" : "68257",
                        "points" : [ {
                          "x" : 1580403900,
                          "y" : 128.249
                        }, {
                          "x" : 1580403900,
                          "y" : 128.249
                        } ]
                      } ],
                      "alertCount" : 398,
                      "testType" : "Web - HTTP Server",
                      "testId" : "68256",
                      "isShared" : true,
                      "testName" : "Http Test Name",
                      "target" : "www.google.com"
                    }, {
                      "graphlets" : [ {
                        "metric" : "Availability",
                        "testId" : "68257",
                        "points" : [ {
                          "x" : 1580403900,
                          "y" : 128.249
                        }, {
                          "x" : 1580403900,
                          "y" : 128.249
                        } ]
                      }, {
                        "metric" : "Availability",
                        "testId" : "68257",
                        "points" : [ {
                          "x" : 1580403900,
                          "y" : 128.249
                        }, {
                          "x" : 1580403900,
                          "y" : 128.249
                        } ]
                      } ],
                      "alertCount" : 398,
                      "testType" : "Web - HTTP Server",
                      "testId" : "68256",
                      "isShared" : true,
                      "testName" : "Http Test Name",
                      "target" : "www.google.com"
                    } ],
                    "columns" : [ {
                      "columnId" : "938to",
                      "alertSuppressionWindows" : [ {
                        "testIds" : [ "281474976710661" ],
                        "repeatUnit" : "week",
                        "durationInSeconds" : 7200,
                        "repeat" : "custom",
                        "name" : "Test dashboards",
                        "repeatEvery" : 5,
                        "id" : "281474976710662",
                        "startTimes" : [ "2023-05-16T10:14:28Z" ]
                      }, {
                        "testIds" : [ "281474976710661" ],
                        "repeatUnit" : "week",
                        "durationInSeconds" : 7200,
                        "repeat" : "custom",
                        "name" : "Test dashboards",
                        "repeatEvery" : 5,
                        "id" : "281474976710662",
                        "startTimes" : [ "2023-05-16T10:14:28Z" ]
                      } ],
                      "binSize" : 3600,
                      "points" : [ {
                        "numberOfDataPoints" : 23304,
                        "groups" : [ {
                          "groupProperty" : "COUNTRY",
                          "groupValue" : "US"
                        }, {
                          "groupProperty" : "COUNTRY",
                          "groupValue" : "US"
                        } ],
                        "value" : 100.0,
                        "timestamp" : 1567620000
                      }, {
                        "numberOfDataPoints" : 23304,
                        "groups" : [ {
                          "groupProperty" : "COUNTRY",
                          "groupValue" : "US"
                        }, {
                          "groupProperty" : "COUNTRY",
                          "groupValue" : "US"
                        } ],
                        "value" : 100.0,
                        "timestamp" : 1567620000
                      } ],
                      "status" : "No data"
                    }, {
                      "columnId" : "938to",
                      "alertSuppressionWindows" : [ {
                        "testIds" : [ "281474976710661" ],
                        "repeatUnit" : "week",
                        "durationInSeconds" : 7200,
                        "repeat" : "custom",
                        "name" : "Test dashboards",
                        "repeatEvery" : 5,
                        "id" : "281474976710662",
                        "startTimes" : [ "2023-05-16T10:14:28Z" ]
                      }, {
                        "testIds" : [ "281474976710661" ],
                        "repeatUnit" : "week",
                        "durationInSeconds" : 7200,
                        "repeat" : "custom",
                        "name" : "Test dashboards",
                        "repeatEvery" : 5,
                        "id" : "281474976710662",
                        "startTimes" : [ "2023-05-16T10:14:28Z" ]
                      } ],
                      "binSize" : 3600,
                      "points" : [ {
                        "numberOfDataPoints" : 23304,
                        "groups" : [ {
                          "groupProperty" : "COUNTRY",
                          "groupValue" : "US"
                        }, {
                          "groupProperty" : "COUNTRY",
                          "groupValue" : "US"
                        } ],
                        "value" : 100.0,
                        "timestamp" : 1567620000
                      }, {
                        "numberOfDataPoints" : 23304,
                        "groups" : [ {
                          "groupProperty" : "COUNTRY",
                          "groupValue" : "US"
                        }, {
                          "groupProperty" : "COUNTRY",
                          "groupValue" : "US"
                        } ],
                        "value" : 100.0,
                        "timestamp" : 1567620000
                      } ],
                      "status" : "No data"
                    } ],
                    "alertSuppressionWindows" : [ {
                      "testIds" : [ "281474976710661" ],
                      "repeatUnit" : "week",
                      "durationInSeconds" : 7200,
                      "repeat" : "custom",
                      "name" : "Test dashboards",
                      "repeatEvery" : 5,
                      "id" : "281474976710662",
                      "startTimes" : [ "2023-05-16T10:14:28Z" ]
                    }, {
                      "testIds" : [ "281474976710661" ],
                      "repeatUnit" : "week",
                      "durationInSeconds" : 7200,
                      "repeat" : "custom",
                      "name" : "Test dashboards",
                      "repeatEvery" : 5,
                      "id" : "281474976710662",
                      "startTimes" : [ "2023-05-16T10:14:28Z" ]
                    } ],
                    "activeAlerts" : 483,
                    "startRound" : 1384309800,
                    "points" : [ {
                      "numberOfDataPoints" : 23304,
                      "groups" : [ {
                        "groupProperty" : "COUNTRY",
                        "groupValue" : "US"
                      }, {
                        "groupProperty" : "COUNTRY",
                        "groupValue" : "US"
                      } ],
                      "value" : 100.0,
                      "timestamp" : 1567620000
                    }, {
                      "numberOfDataPoints" : 23304,
                      "groups" : [ {
                        "groupProperty" : "COUNTRY",
                        "groupValue" : "US"
                      }, {
                        "groupProperty" : "COUNTRY",
                        "groupValue" : "US"
                      } ],
                      "value" : 100.0,
                      "timestamp" : 1567620000
                    } ],
                    "agents" : [ {
                      "agentId" : "6522",
                      "agentName" : "0c3898000117",
                      "location" : {
                        "locationName" : "San Francisco, California, US",
                        "latitude" : 37.77493,
                        "longitude" : -122.41942
                      },
                      "ipInfo" : {
                        "ipv6" : "ipv6",
                        "privateIp" : "172.58.92.31",
                        "operativeSystemVersion" : "operativeSystemVersion",
                        "publicIp" : "172.58.92.31"
                      },
                      "status" : "online"
                    }, {
                      "agentId" : "6522",
                      "agentName" : "0c3898000117",
                      "location" : {
                        "locationName" : "San Francisco, California, US",
                        "latitude" : 37.77493,
                        "longitude" : -122.41942
                      },
                      "ipInfo" : {
                        "ipv6" : "ipv6",
                        "privateIp" : "172.58.92.31",
                        "operativeSystemVersion" : "operativeSystemVersion",
                        "publicIp" : "172.58.92.31"
                      },
                      "status" : "online"
                    } ],
                    "status" : "No data"
                  },
                  "endDate" : "2022-07-18T22:00:54Z",
                  "_links" : {
                    "self" : {
                      "hreflang" : "hreflang",
                      "templated" : true,
                      "profile" : "profile",
                      "name" : "name",
                      "href" : "https://api.thousandeyes.com/v7/link/to/resource/id",
                      "type" : "type",
                      "deprecation" : "deprecation",
                      "title" : "title"
                    }
                  },
                  "binSize" : 3600,
                  "startDate" : "2022-07-17T22:00:54Z"
                }
                                  """;
        var statusCode = 200;
        var responseContentType = "application/json";
        ApiWidgetDataSnapshotResponse mappedResponse = 
                mapper.readValue(responseBodyJson, ApiWidgetDataSnapshotResponse.class);
        assertNotNull(mappedResponse);

        var path = "/dashboard-snapshots/{snapshotId}/widgets/{widgetId}";
        stubFor(get(urlPathTemplate(path))
                        .withPathParam("snapshotId", equalTo(URLEncoder.encode(snapshotId, StandardCharsets.UTF_8)))
                        .withPathParam("widgetId", equalTo(URLEncoder.encode(widgetId, StandardCharsets.UTF_8)))
                        .withHeader(AUTHORIZATION, equalTo(BEARER_TOKEN))
                        .willReturn(aResponse()
                                            .withHeader(CONTENT_TYPE, responseContentType)
                                            .withBody(responseBodyJson)
                                            .withStatus(statusCode)));

        var apiResponse = api.getDashboardSnapshotWidgetData(snapshotId, widgetId, null);
        assertEquals(mappedResponse, apiResponse);
    }
    
    /**
     * List dashboard snapshots
     * <p>
     * Returns a list of dashboard snapshots within your account group. Use this data to identify a specific dashboard snapshot, which can be used in other endpoints to access aggregated data. The &#x60;View Snapshots&#x60; permission is required to use this endpoint.\&quot; 
     *
     * @throws JsonProcessingException if the deserialization fails
     */
    @Test
    public void getDashboardSnapshotsRequestAndResponseDeserializationTest()
            throws JsonProcessingException, ApiException
    {


        var responseBodyJson = """
                {
                  "pages" : {
                    "key" : ""
                  },
                  "_links" : {
                    "next" : {
                      "hreflang" : "hreflang",
                      "templated" : true,
                      "profile" : "profile",
                      "name" : "name",
                      "href" : "https://api.thousandeyes.com/v7/link/to/resource/id",
                      "type" : "type",
                      "deprecation" : "deprecation",
                      "title" : "title"
                    },
                    "previous" : {
                      "hreflang" : "hreflang",
                      "templated" : true,
                      "profile" : "profile",
                      "name" : "name",
                      "href" : "https://api.thousandeyes.com/v7/link/to/resource/id",
                      "type" : "type",
                      "deprecation" : "deprecation",
                      "title" : "title"
                    },
                    "self" : {
                      "hreflang" : "hreflang",
                      "templated" : true,
                      "profile" : "profile",
                      "name" : "name",
                      "href" : "https://api.thousandeyes.com/v7/link/to/resource/id",
                      "type" : "type",
                      "deprecation" : "deprecation",
                      "title" : "title"
                    }
                  },
                  "dashboardSnapshots" : [ {
                    "snapshotId" : "d28bb71f-5a47-4783-8f12-d4b115e61b0c",
                    "_links" : {
                      "appLink" : {
                        "hreflang" : "hreflang",
                        "templated" : true,
                        "profile" : "profile",
                        "name" : "name",
                        "href" : "https://api.thousandeyes.com/v7/link/to/resource/id",
                        "type" : "type",
                        "deprecation" : "deprecation",
                        "title" : "title"
                      },
                      "self" : {
                        "hreflang" : "hreflang",
                        "templated" : true,
                        "profile" : "profile",
                        "name" : "name",
                        "href" : "https://api.thousandeyes.com/v7/link/to/resource/id",
                        "type" : "type",
                        "deprecation" : "deprecation",
                        "title" : "title"
                      }
                    },
                    "apiLinks" : [ {
                      "key" : ""
                    }, {
                      "key" : ""
                    } ],
                    "snapshotExpirationDate" : "2023-05-16T10:14:28Z",
                    "isScheduled" : true,
                    "widgets" : [ {
                      "embedUrl" : "https://embed.thousandeyes.com/e/00aa:3039802d-5c76-42d2-9a93-c6e5f9d3122f",
                      "shouldExcludeAlertSuppressionWindows" : true,
                      "_links" : {
                        "self" : {
                          "hreflang" : "hreflang",
                          "templated" : true,
                          "profile" : "profile",
                          "name" : "name",
                          "href" : "https://api.thousandeyes.com/v7/link/to/resource/id",
                          "type" : "type",
                          "deprecation" : "deprecation",
                          "title" : "title"
                        }
                      },
                      "visualMode" : "Full",
                      "filters" : {
                        "TEST" : [ 5187, 5227 ],
                        "ENDPOINT_MACHINE_ID" : [ "fbd0050c-07f7-43f7-9631-14b32f096962" ]
                      },
                      "title" : "Widget Title",
                      "type" : "Agent Status",
                      "metricGroup" : "BGP",
                      "measure" : {
                        "percentileValue" : 95.0,
                        "type" : "MEAN"
                      },
                      "apiLink" : "apiLink",
                      "metric" : "ENDPOINT_GATEWAY_CPU_LOAD_PERCENT",
                      "isEmbedded" : true,
                      "id" : "1234",
                      "fixedTimespan" : {
                        "unit" : "Days",
                        "value" : 10
                      },
                      "dataSource" : "ENDPOINT_AGENTS",
                      "direction" : "FROM_TARGET"
                    }, {
                      "embedUrl" : "https://embed.thousandeyes.com/e/00aa:3039802d-5c76-42d2-9a93-c6e5f9d3122f",
                      "shouldExcludeAlertSuppressionWindows" : true,
                      "_links" : {
                        "self" : {
                          "hreflang" : "hreflang",
                          "templated" : true,
                          "profile" : "profile",
                          "name" : "name",
                          "href" : "https://api.thousandeyes.com/v7/link/to/resource/id",
                          "type" : "type",
                          "deprecation" : "deprecation",
                          "title" : "title"
                        }
                      },
                      "visualMode" : "Full",
                      "filters" : {
                        "TEST" : [ 5187, 5227 ],
                        "ENDPOINT_MACHINE_ID" : [ "fbd0050c-07f7-43f7-9631-14b32f096962" ]
                      },
                      "title" : "Widget Title",
                      "type" : "Agent Status",
                      "metricGroup" : "BGP",
                      "measure" : {
                        "percentileValue" : 95.0,
                        "type" : "MEAN"
                      },
                      "apiLink" : "apiLink",
                      "metric" : "ENDPOINT_GATEWAY_CPU_LOAD_PERCENT",
                      "isEmbedded" : true,
                      "id" : "1234",
                      "fixedTimespan" : {
                        "unit" : "Days",
                        "value" : 10
                      },
                      "dataSource" : "ENDPOINT_AGENTS",
                      "direction" : "FROM_TARGET"
                    } ],
                    "accountId" : 1234,
                    "createdDate" : "2023-05-16 10:14:28",
                    "snapshotName" : "HTTP Server Dashboard Snapshot",
                    "timeSpan" : {
                      "duration" : 60,
                      "start" : "2023-05-16T10:14:28Z",
                      "startDate" : "2023-05-16 10:14:28"
                    },
                    "permalink" : "https://app.thousandeyes.com/dashboard/?snapshotId=d28bb71f-5a47-4783-8f12-d4b115e61b0c",
                    "aid" : "1234",
                    "snapshotCreatedDate" : "2023-05-16T10:14:28Z",
                    "isShared" : true,
                    "dashboard" : {
                      "isMigratedReport" : false,
                      "dashboardCreatedBy" : "1",
                      "_links" : {
                        "snapshots" : {
                          "hreflang" : "hreflang",
                          "templated" : true,
                          "profile" : "profile",
                          "name" : "name",
                          "href" : "https://api.thousandeyes.com/v7/link/to/resource/id",
                          "type" : "type",
                          "deprecation" : "deprecation",
                          "title" : "title"
                        },
                        "self" : {
                          "hreflang" : "hreflang",
                          "templated" : true,
                          "profile" : "profile",
                          "name" : "name",
                          "href" : "https://api.thousandeyes.com/v7/link/to/resource/id",
                          "type" : "type",
                          "deprecation" : "deprecation",
                          "title" : "title"
                        }
                      },
                      "dashboardModifiedBy" : "1",
                      "migratedReport" : false,
                      "isDefaultForAccount" : false,
                      "isDefaultForUser" : true,
                      "description" : "HTTP Server Widgets",
                      "isPrivate" : true,
                      "title" : "HTTP Server Widgets",
                      "isBuiltIn" : true,
                      "widgets" : [ {
                        "embedUrl" : "https://embed.thousandeyes.com/e/00aa:3039802d-5c76-42d2-9a93-c6e5f9d3122f",
                        "shouldExcludeAlertSuppressionWindows" : true,
                        "_links" : {
                          "self" : {
                            "hreflang" : "hreflang",
                            "templated" : true,
                            "profile" : "profile",
                            "name" : "name",
                            "href" : "https://api.thousandeyes.com/v7/link/to/resource/id",
                            "type" : "type",
                            "deprecation" : "deprecation",
                            "title" : "title"
                          }
                        },
                        "visualMode" : "Full",
                        "filters" : {
                          "TEST" : [ 5187, 5227 ],
                          "ENDPOINT_MACHINE_ID" : [ "fbd0050c-07f7-43f7-9631-14b32f096962" ]
                        },
                        "title" : "Widget Title",
                        "type" : "Agent Status",
                        "metricGroup" : "BGP",
                        "measure" : {
                          "percentileValue" : 95.0,
                          "type" : "MEAN"
                        },
                        "apiLink" : "apiLink",
                        "metric" : "ENDPOINT_GATEWAY_CPU_LOAD_PERCENT",
                        "isEmbedded" : true,
                        "id" : "1234",
                        "fixedTimespan" : {
                          "unit" : "Days",
                          "value" : 10
                        },
                        "dataSource" : "ENDPOINT_AGENTS",
                        "direction" : "FROM_TARGET"
                      }, {
                        "embedUrl" : "https://embed.thousandeyes.com/e/00aa:3039802d-5c76-42d2-9a93-c6e5f9d3122f",
                        "shouldExcludeAlertSuppressionWindows" : true,
                        "_links" : {
                          "self" : {
                            "hreflang" : "hreflang",
                            "templated" : true,
                            "profile" : "profile",
                            "name" : "name",
                            "href" : "https://api.thousandeyes.com/v7/link/to/resource/id",
                            "type" : "type",
                            "deprecation" : "deprecation",
                            "title" : "title"
                          }
                        },
                        "visualMode" : "Full",
                        "filters" : {
                          "TEST" : [ 5187, 5227 ],
                          "ENDPOINT_MACHINE_ID" : [ "fbd0050c-07f7-43f7-9631-14b32f096962" ]
                        },
                        "title" : "Widget Title",
                        "type" : "Agent Status",
                        "metricGroup" : "BGP",
                        "measure" : {
                          "percentileValue" : 95.0,
                          "type" : "MEAN"
                        },
                        "apiLink" : "apiLink",
                        "metric" : "ENDPOINT_GATEWAY_CPU_LOAD_PERCENT",
                        "isEmbedded" : true,
                        "id" : "1234",
                        "fixedTimespan" : {
                          "unit" : "Days",
                          "value" : 10
                        },
                        "dataSource" : "ENDPOINT_AGENTS",
                        "direction" : "FROM_TARGET"
                      } ],
                      "defaultTimespan" : {
                        "duration" : 7200,
                        "timespanDuration" : 7200,
                        "start" : "2023-05-16T10:14:28Z",
                        "end" : "2023-05-16T11:14:28Z",
                        "timespanStart" : "2023-05-16 10:14:28",
                        "timespanEnd" : "2023-05-16 11:14:28"
                      },
                      "globalFilterId" : "65babd9bb90bf55b17c96c8d",
                      "accountId" : 1234,
                      "apiLink" : [ {
                        "key" : ""
                      }, {
                        "key" : ""
                      } ],
                      "dashboardId" : "5e1f7a99143ae6004fdc3bb4",
                      "createdBy" : 1,
                      "globalOverride" : true,
                      "modifiedDate" : "2023-05-16 10:14:28",
                      "modifiedBy" : 1,
                      "isGlobalOverride" : true,
                      "aid" : "1234",
                      "dashboardModifiedDate" : "2023-05-16T10:14:28Z"
                    },
                    "expirationDate" : "2023-05-16 10:14:28"
                  }, {
                    "snapshotId" : "d28bb71f-5a47-4783-8f12-d4b115e61b0c",
                    "_links" : {
                      "appLink" : {
                        "hreflang" : "hreflang",
                        "templated" : true,
                        "profile" : "profile",
                        "name" : "name",
                        "href" : "https://api.thousandeyes.com/v7/link/to/resource/id",
                        "type" : "type",
                        "deprecation" : "deprecation",
                        "title" : "title"
                      },
                      "self" : {
                        "hreflang" : "hreflang",
                        "templated" : true,
                        "profile" : "profile",
                        "name" : "name",
                        "href" : "https://api.thousandeyes.com/v7/link/to/resource/id",
                        "type" : "type",
                        "deprecation" : "deprecation",
                        "title" : "title"
                      }
                    },
                    "apiLinks" : [ {
                      "key" : ""
                    }, {
                      "key" : ""
                    } ],
                    "snapshotExpirationDate" : "2023-05-16T10:14:28Z",
                    "isScheduled" : true,
                    "widgets" : [ {
                      "embedUrl" : "https://embed.thousandeyes.com/e/00aa:3039802d-5c76-42d2-9a93-c6e5f9d3122f",
                      "shouldExcludeAlertSuppressionWindows" : true,
                      "_links" : {
                        "self" : {
                          "hreflang" : "hreflang",
                          "templated" : true,
                          "profile" : "profile",
                          "name" : "name",
                          "href" : "https://api.thousandeyes.com/v7/link/to/resource/id",
                          "type" : "type",
                          "deprecation" : "deprecation",
                          "title" : "title"
                        }
                      },
                      "visualMode" : "Full",
                      "filters" : {
                        "TEST" : [ 5187, 5227 ],
                        "ENDPOINT_MACHINE_ID" : [ "fbd0050c-07f7-43f7-9631-14b32f096962" ]
                      },
                      "title" : "Widget Title",
                      "type" : "Agent Status",
                      "metricGroup" : "BGP",
                      "measure" : {
                        "percentileValue" : 95.0,
                        "type" : "MEAN"
                      },
                      "apiLink" : "apiLink",
                      "metric" : "ENDPOINT_GATEWAY_CPU_LOAD_PERCENT",
                      "isEmbedded" : true,
                      "id" : "1234",
                      "fixedTimespan" : {
                        "unit" : "Days",
                        "value" : 10
                      },
                      "dataSource" : "ENDPOINT_AGENTS",
                      "direction" : "FROM_TARGET"
                    }, {
                      "embedUrl" : "https://embed.thousandeyes.com/e/00aa:3039802d-5c76-42d2-9a93-c6e5f9d3122f",
                      "shouldExcludeAlertSuppressionWindows" : true,
                      "_links" : {
                        "self" : {
                          "hreflang" : "hreflang",
                          "templated" : true,
                          "profile" : "profile",
                          "name" : "name",
                          "href" : "https://api.thousandeyes.com/v7/link/to/resource/id",
                          "type" : "type",
                          "deprecation" : "deprecation",
                          "title" : "title"
                        }
                      },
                      "visualMode" : "Full",
                      "filters" : {
                        "TEST" : [ 5187, 5227 ],
                        "ENDPOINT_MACHINE_ID" : [ "fbd0050c-07f7-43f7-9631-14b32f096962" ]
                      },
                      "title" : "Widget Title",
                      "type" : "Agent Status",
                      "metricGroup" : "BGP",
                      "measure" : {
                        "percentileValue" : 95.0,
                        "type" : "MEAN"
                      },
                      "apiLink" : "apiLink",
                      "metric" : "ENDPOINT_GATEWAY_CPU_LOAD_PERCENT",
                      "isEmbedded" : true,
                      "id" : "1234",
                      "fixedTimespan" : {
                        "unit" : "Days",
                        "value" : 10
                      },
                      "dataSource" : "ENDPOINT_AGENTS",
                      "direction" : "FROM_TARGET"
                    } ],
                    "accountId" : 1234,
                    "createdDate" : "2023-05-16 10:14:28",
                    "snapshotName" : "HTTP Server Dashboard Snapshot",
                    "timeSpan" : {
                      "duration" : 60,
                      "start" : "2023-05-16T10:14:28Z",
                      "startDate" : "2023-05-16 10:14:28"
                    },
                    "permalink" : "https://app.thousandeyes.com/dashboard/?snapshotId=d28bb71f-5a47-4783-8f12-d4b115e61b0c",
                    "aid" : "1234",
                    "snapshotCreatedDate" : "2023-05-16T10:14:28Z",
                    "isShared" : true,
                    "dashboard" : {
                      "isMigratedReport" : false,
                      "dashboardCreatedBy" : "1",
                      "_links" : {
                        "snapshots" : {
                          "hreflang" : "hreflang",
                          "templated" : true,
                          "profile" : "profile",
                          "name" : "name",
                          "href" : "https://api.thousandeyes.com/v7/link/to/resource/id",
                          "type" : "type",
                          "deprecation" : "deprecation",
                          "title" : "title"
                        },
                        "self" : {
                          "hreflang" : "hreflang",
                          "templated" : true,
                          "profile" : "profile",
                          "name" : "name",
                          "href" : "https://api.thousandeyes.com/v7/link/to/resource/id",
                          "type" : "type",
                          "deprecation" : "deprecation",
                          "title" : "title"
                        }
                      },
                      "dashboardModifiedBy" : "1",
                      "migratedReport" : false,
                      "isDefaultForAccount" : false,
                      "isDefaultForUser" : true,
                      "description" : "HTTP Server Widgets",
                      "isPrivate" : true,
                      "title" : "HTTP Server Widgets",
                      "isBuiltIn" : true,
                      "widgets" : [ {
                        "embedUrl" : "https://embed.thousandeyes.com/e/00aa:3039802d-5c76-42d2-9a93-c6e5f9d3122f",
                        "shouldExcludeAlertSuppressionWindows" : true,
                        "_links" : {
                          "self" : {
                            "hreflang" : "hreflang",
                            "templated" : true,
                            "profile" : "profile",
                            "name" : "name",
                            "href" : "https://api.thousandeyes.com/v7/link/to/resource/id",
                            "type" : "type",
                            "deprecation" : "deprecation",
                            "title" : "title"
                          }
                        },
                        "visualMode" : "Full",
                        "filters" : {
                          "TEST" : [ 5187, 5227 ],
                          "ENDPOINT_MACHINE_ID" : [ "fbd0050c-07f7-43f7-9631-14b32f096962" ]
                        },
                        "title" : "Widget Title",
                        "type" : "Agent Status",
                        "metricGroup" : "BGP",
                        "measure" : {
                          "percentileValue" : 95.0,
                          "type" : "MEAN"
                        },
                        "apiLink" : "apiLink",
                        "metric" : "ENDPOINT_GATEWAY_CPU_LOAD_PERCENT",
                        "isEmbedded" : true,
                        "id" : "1234",
                        "fixedTimespan" : {
                          "unit" : "Days",
                          "value" : 10
                        },
                        "dataSource" : "ENDPOINT_AGENTS",
                        "direction" : "FROM_TARGET"
                      }, {
                        "embedUrl" : "https://embed.thousandeyes.com/e/00aa:3039802d-5c76-42d2-9a93-c6e5f9d3122f",
                        "shouldExcludeAlertSuppressionWindows" : true,
                        "_links" : {
                          "self" : {
                            "hreflang" : "hreflang",
                            "templated" : true,
                            "profile" : "profile",
                            "name" : "name",
                            "href" : "https://api.thousandeyes.com/v7/link/to/resource/id",
                            "type" : "type",
                            "deprecation" : "deprecation",
                            "title" : "title"
                          }
                        },
                        "visualMode" : "Full",
                        "filters" : {
                          "TEST" : [ 5187, 5227 ],
                          "ENDPOINT_MACHINE_ID" : [ "fbd0050c-07f7-43f7-9631-14b32f096962" ]
                        },
                        "title" : "Widget Title",
                        "type" : "Agent Status",
                        "metricGroup" : "BGP",
                        "measure" : {
                          "percentileValue" : 95.0,
                          "type" : "MEAN"
                        },
                        "apiLink" : "apiLink",
                        "metric" : "ENDPOINT_GATEWAY_CPU_LOAD_PERCENT",
                        "isEmbedded" : true,
                        "id" : "1234",
                        "fixedTimespan" : {
                          "unit" : "Days",
                          "value" : 10
                        },
                        "dataSource" : "ENDPOINT_AGENTS",
                        "direction" : "FROM_TARGET"
                      } ],
                      "defaultTimespan" : {
                        "duration" : 7200,
                        "timespanDuration" : 7200,
                        "start" : "2023-05-16T10:14:28Z",
                        "end" : "2023-05-16T11:14:28Z",
                        "timespanStart" : "2023-05-16 10:14:28",
                        "timespanEnd" : "2023-05-16 11:14:28"
                      },
                      "globalFilterId" : "65babd9bb90bf55b17c96c8d",
                      "accountId" : 1234,
                      "apiLink" : [ {
                        "key" : ""
                      }, {
                        "key" : ""
                      } ],
                      "dashboardId" : "5e1f7a99143ae6004fdc3bb4",
                      "createdBy" : 1,
                      "globalOverride" : true,
                      "modifiedDate" : "2023-05-16 10:14:28",
                      "modifiedBy" : 1,
                      "isGlobalOverride" : true,
                      "aid" : "1234",
                      "dashboardModifiedDate" : "2023-05-16T10:14:28Z"
                    },
                    "expirationDate" : "2023-05-16 10:14:28"
                  } ]
                }
                                  """;
        var statusCode = 200;
        var responseContentType = "application/json";
        DashboardSnapshotsPage mappedResponse = 
                mapper.readValue(responseBodyJson, DashboardSnapshotsPage.class);
        assertNotNull(mappedResponse);

        var path = "/dashboard-snapshots";
        stubFor(get(urlPathTemplate(path))
                        .withHeader(AUTHORIZATION, equalTo(BEARER_TOKEN))
                        .willReturn(aResponse()
                                            .withHeader(CONTENT_TYPE, responseContentType)
                                            .withBody(responseBodyJson)
                                            .withStatus(statusCode)));

        var apiResponse = api.getDashboardSnapshots(null, null, null);
        assertEquals(mappedResponse, apiResponse);
    }
    
    /**
     * Update snapshot expiration
     * <p>
     * Updates the expiration date of a dashboard snapshot. The &#x60;Edit snapshots&#x60; permission is required to access this endpoint. 
     *
     * @throws JsonProcessingException if the deserialization fails
     */
    @Test
    public void updateDashboardSnapshotExpirationDateRequestAndResponseDeserializationTest()
            throws JsonProcessingException, ApiException
    {
        String snapshotId = "d28bb71f-5a47-4783-8f12-d4b115e61b0c";

        var requestBodyJson = """
                {
                  "snapshotExpirationDate" : "2023-05-16T10:14:28Z",
                  "expirationDate" : "2023-05-16 10:14:28"
                }
                                 """;
        var requestBodyContentType = "application/json";
        UpdateSnapshotExpirationDateApiRequest mappedRequest = 
                mapper.readValue(requestBodyJson, UpdateSnapshotExpirationDateApiRequest.class);
        assertNotNull(mappedRequest);

        var statusCode = 204;

        var path = "/dashboard-snapshots/{snapshotId}";
        stubFor(patch(urlPathTemplate(path))
                        .withPathParam("snapshotId", equalTo(URLEncoder.encode(snapshotId, StandardCharsets.UTF_8)))
                        .withHeader(AUTHORIZATION, equalTo(BEARER_TOKEN))
                        .withHeader(CONTENT_TYPE, equalTo(requestBodyContentType))
                        .withRequestBody(equalToJson(requestBodyJson))
                        .willReturn(aResponse()
                                            .withStatus(statusCode)));

        var apiResponse = api.updateDashboardSnapshotExpirationDateWithHttpInfo(snapshotId, mappedRequest, null);
        assertEquals(statusCode, apiResponse.getStatusCode());
    }
    
}
