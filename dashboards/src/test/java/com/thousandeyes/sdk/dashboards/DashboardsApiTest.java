/*
 * Dashboards API
 * Manage ThousandEyes Dashboards.
 *
 * 
 *
 * NOTE: This class is auto generated by OpenAPI Generator (https://openapi-generator.tech).
 * https://openapi-generator.tech
 * Do not edit the class manually.
 */


package com.thousandeyes.sdk.dashboards;

import com.thousandeyes.sdk.dashboards.model.ApiDashboard;
import com.thousandeyes.sdk.dashboards.model.ApiMultiMetricColumnData;
import com.thousandeyes.sdk.dashboards.model.ApiNumbersCardData;
import com.thousandeyes.sdk.dashboards.model.ApiWidgetDataResponse;
import java.math.BigDecimal;
import com.thousandeyes.sdk.dashboards.model.Dashboard;
import com.thousandeyes.sdk.dashboards.model.DashboardOrder;
import com.thousandeyes.sdk.dashboards.model.Error;
import java.time.OffsetDateTime;
import java.net.URI;
import com.thousandeyes.sdk.dashboards.model.UnauthorizedError;
import com.thousandeyes.sdk.dashboards.model.ValidationError;
import static com.github.tomakehurst.wiremock.client.WireMock.*;
import static com.github.tomakehurst.wiremock.common.ContentTypes.AUTHORIZATION;
import static com.github.tomakehurst.wiremock.common.ContentTypes.CONTENT_TYPE;
import static com.thousandeyes.sdk.serialization.JSON.getDefault;
import static org.junit.jupiter.api.Assertions.assertEquals;
import static org.junit.jupiter.api.Assertions.assertNotNull;

import java.net.URLEncoder;
import java.nio.charset.StandardCharsets;

import org.junit.jupiter.api.BeforeAll;
import org.junit.jupiter.api.Test;

import com.fasterxml.jackson.core.JsonProcessingException;
import com.fasterxml.jackson.core.type.TypeReference;
import com.fasterxml.jackson.databind.DeserializationFeature;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.github.tomakehurst.wiremock.junit5.WireMockRuntimeInfo;
import com.github.tomakehurst.wiremock.junit5.WireMockTest;

import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;
import java.util.Set;

import com.thousandeyes.sdk.client.ApiClient;
import com.thousandeyes.sdk.client.ApiException;
import com.thousandeyes.sdk.client.NativeApiClient;


/**
 * Request and Response model deserialization tests for DashboardsApi
 */
@WireMockTest
public class DashboardsApiTest {
    private static final String TOKEN = "valid-token";
    private static final String BEARER_TOKEN = "Bearer %s".formatted(TOKEN);
    private static DashboardsApi api;
    private final ObjectMapper mapper = getDefault()
            .getMapper()
            .configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES, true);

    @BeforeAll
    public static void setup(WireMockRuntimeInfo wireMockRuntimeInfo) {
        ApiClient client = NativeApiClient.builder()
                                .baseUri(wireMockRuntimeInfo.getHttpBaseUrl())
                                .bearerToken(TOKEN)
                                .build();
        api = new DashboardsApi(client);
    }
    
    /**
     * Create dashboard
     * <p>
     * Creates a new dashboard in your account group. To create a dashboard,  you must have one of the following permissions: * &#x60;Edit dashboard templates for all users in account group&#x60; permission (Account Admin).  * &#x60;Edit own dashboard templates&#x60; permission (Regular User). 
     *
     * @throws JsonProcessingException if the deserialization fails
     */
    @Test
    public void createDashboardRequestAndResponseDeserializationTest()
            throws JsonProcessingException, ApiException
    {

        var requestBodyJson = """
                {
                  "isMigratedReport" : false,
                  "_links" : {
                    "snapshots" : {
                      "hreflang" : "hreflang",
                      "templated" : true,
                      "profile" : "profile",
                      "name" : "name",
                      "href" : "https://api.thousandeyes.com/v7/link/to/resource/id",
                      "type" : "type",
                      "deprecation" : "deprecation",
                      "title" : "title"
                    },
                    "self" : {
                      "hreflang" : "hreflang",
                      "templated" : true,
                      "profile" : "profile",
                      "name" : "name",
                      "href" : "https://api.thousandeyes.com/v7/link/to/resource/id",
                      "type" : "type",
                      "deprecation" : "deprecation",
                      "title" : "title"
                    }
                  },
                  "isDefaultForAccount" : false,
                  "isDefaultForUser" : true,
                  "description" : "HTTP Server Widgets",
                  "isPrivate" : true,
                  "title" : "HTTP Server Widgets",
                  "isBuiltIn" : true,
                  "widgets" : [ {
                    "embedUrl" : "https://embed.thousandeyes.com/e/00aa:3039802d-5c76-42d2-9a93-c6e5f9d3122f",
                    "shouldExcludeAlertSuppressionWindows" : true,
                    "_links" : {
                      "self" : {
                        "hreflang" : "hreflang",
                        "templated" : true,
                        "profile" : "profile",
                        "name" : "name",
                        "href" : "https://api.thousandeyes.com/v7/link/to/resource/id",
                        "type" : "type",
                        "deprecation" : "deprecation",
                        "title" : "title"
                      }
                    },
                    "visualMode" : "Full",
                    "filters" : {
                      "TEST" : [ 5187, 5227 ],
                      "ENDPOINT_MACHINE_ID" : [ "fbd0050c-07f7-43f7-9631-14b32f096962" ]
                    },
                    "title" : "Widget Title",
                    "type" : "Agent Status",
                    "metricGroup" : "BGP",
                    "measure" : {
                      "percentileValue" : 95.0,
                      "type" : "MEAN"
                    },
                    "apiLink" : "apiLink",
                    "metric" : "ENDPOINT_GATEWAY_CPU_LOAD_PERCENT",
                    "isEmbedded" : true,
                    "id" : "1234",
                    "fixedTimespan" : {
                      "unit" : "Days",
                      "value" : 10
                    },
                    "dataSource" : "ENDPOINT_AGENTS",
                    "direction" : "FROM_TARGET"
                  }, {
                    "embedUrl" : "https://embed.thousandeyes.com/e/00aa:3039802d-5c76-42d2-9a93-c6e5f9d3122f",
                    "shouldExcludeAlertSuppressionWindows" : true,
                    "_links" : {
                      "self" : {
                        "hreflang" : "hreflang",
                        "templated" : true,
                        "profile" : "profile",
                        "name" : "name",
                        "href" : "https://api.thousandeyes.com/v7/link/to/resource/id",
                        "type" : "type",
                        "deprecation" : "deprecation",
                        "title" : "title"
                      }
                    },
                    "visualMode" : "Full",
                    "filters" : {
                      "TEST" : [ 5187, 5227 ],
                      "ENDPOINT_MACHINE_ID" : [ "fbd0050c-07f7-43f7-9631-14b32f096962" ]
                    },
                    "title" : "Widget Title",
                    "type" : "Agent Status",
                    "metricGroup" : "BGP",
                    "measure" : {
                      "percentileValue" : 95.0,
                      "type" : "MEAN"
                    },
                    "apiLink" : "apiLink",
                    "metric" : "ENDPOINT_GATEWAY_CPU_LOAD_PERCENT",
                    "isEmbedded" : true,
                    "id" : "1234",
                    "fixedTimespan" : {
                      "unit" : "Days",
                      "value" : 10
                    },
                    "dataSource" : "ENDPOINT_AGENTS",
                    "direction" : "FROM_TARGET"
                  } ],
                  "defaultTimespan" : {
                    "duration" : 7200,
                    "timespanDuration" : 7200,
                    "start" : "2023-05-16T10:14:28Z",
                    "end" : "2023-05-16T11:14:28Z",
                    "timespanStart" : "2023-05-16 10:14:28",
                    "timespanEnd" : "2023-05-16 11:14:28"
                  },
                  "globalFilterId" : "65babd9bb90bf55b17c96c8d",
                  "dashboardId" : "5e1f7a99143ae6004fdc3bb4",
                  "createdBy" : "1",
                  "modifiedDate" : "2023-05-16T10:14:28Z",
                  "modifiedBy" : "1",
                  "isGlobalOverride" : true,
                  "aid" : "1234"
                }
                                 """;
        var requestBodyContentType = "application/json";
        Dashboard mappedRequest = 
                mapper.readValue(requestBodyJson, Dashboard.class);
        assertNotNull(mappedRequest);

        var responseBodyJson = """
                {
                  "isMigratedReport" : false,
                  "_links" : {
                    "snapshots" : {
                      "hreflang" : "hreflang",
                      "templated" : true,
                      "profile" : "profile",
                      "name" : "name",
                      "href" : "https://api.thousandeyes.com/v7/link/to/resource/id",
                      "type" : "type",
                      "deprecation" : "deprecation",
                      "title" : "title"
                    },
                    "self" : {
                      "hreflang" : "hreflang",
                      "templated" : true,
                      "profile" : "profile",
                      "name" : "name",
                      "href" : "https://api.thousandeyes.com/v7/link/to/resource/id",
                      "type" : "type",
                      "deprecation" : "deprecation",
                      "title" : "title"
                    }
                  },
                  "isDefaultForAccount" : false,
                  "isDefaultForUser" : true,
                  "description" : "HTTP Server Widgets",
                  "isPrivate" : true,
                  "title" : "HTTP Server Widgets",
                  "isBuiltIn" : true,
                  "widgets" : [ {
                    "embedUrl" : "https://embed.thousandeyes.com/e/00aa:3039802d-5c76-42d2-9a93-c6e5f9d3122f",
                    "shouldExcludeAlertSuppressionWindows" : true,
                    "_links" : {
                      "self" : {
                        "hreflang" : "hreflang",
                        "templated" : true,
                        "profile" : "profile",
                        "name" : "name",
                        "href" : "https://api.thousandeyes.com/v7/link/to/resource/id",
                        "type" : "type",
                        "deprecation" : "deprecation",
                        "title" : "title"
                      }
                    },
                    "visualMode" : "Full",
                    "filters" : {
                      "TEST" : [ 5187, 5227 ],
                      "ENDPOINT_MACHINE_ID" : [ "fbd0050c-07f7-43f7-9631-14b32f096962" ]
                    },
                    "title" : "Widget Title",
                    "type" : "Agent Status",
                    "metricGroup" : "BGP",
                    "measure" : {
                      "percentileValue" : 95.0,
                      "type" : "MEAN"
                    },
                    "apiLink" : "apiLink",
                    "metric" : "ENDPOINT_GATEWAY_CPU_LOAD_PERCENT",
                    "isEmbedded" : true,
                    "id" : "1234",
                    "fixedTimespan" : {
                      "unit" : "Days",
                      "value" : 10
                    },
                    "dataSource" : "ENDPOINT_AGENTS",
                    "direction" : "FROM_TARGET"
                  }, {
                    "embedUrl" : "https://embed.thousandeyes.com/e/00aa:3039802d-5c76-42d2-9a93-c6e5f9d3122f",
                    "shouldExcludeAlertSuppressionWindows" : true,
                    "_links" : {
                      "self" : {
                        "hreflang" : "hreflang",
                        "templated" : true,
                        "profile" : "profile",
                        "name" : "name",
                        "href" : "https://api.thousandeyes.com/v7/link/to/resource/id",
                        "type" : "type",
                        "deprecation" : "deprecation",
                        "title" : "title"
                      }
                    },
                    "visualMode" : "Full",
                    "filters" : {
                      "TEST" : [ 5187, 5227 ],
                      "ENDPOINT_MACHINE_ID" : [ "fbd0050c-07f7-43f7-9631-14b32f096962" ]
                    },
                    "title" : "Widget Title",
                    "type" : "Agent Status",
                    "metricGroup" : "BGP",
                    "measure" : {
                      "percentileValue" : 95.0,
                      "type" : "MEAN"
                    },
                    "apiLink" : "apiLink",
                    "metric" : "ENDPOINT_GATEWAY_CPU_LOAD_PERCENT",
                    "isEmbedded" : true,
                    "id" : "1234",
                    "fixedTimespan" : {
                      "unit" : "Days",
                      "value" : 10
                    },
                    "dataSource" : "ENDPOINT_AGENTS",
                    "direction" : "FROM_TARGET"
                  } ],
                  "defaultTimespan" : {
                    "duration" : 7200,
                    "timespanDuration" : 7200,
                    "start" : "2023-05-16T10:14:28Z",
                    "end" : "2023-05-16T11:14:28Z",
                    "timespanStart" : "2023-05-16 10:14:28",
                    "timespanEnd" : "2023-05-16 11:14:28"
                  },
                  "globalFilterId" : "65babd9bb90bf55b17c96c8d",
                  "dashboardId" : "5e1f7a99143ae6004fdc3bb4",
                  "createdBy" : "1",
                  "modifiedDate" : "2023-05-16T10:14:28Z",
                  "modifiedBy" : "1",
                  "isGlobalOverride" : true,
                  "aid" : "1234"
                }
                                  """;
        var statusCode = 201;
        var responseContentType = "application/json";
        Dashboard mappedResponse = 
                mapper.readValue(responseBodyJson, Dashboard.class);
        assertNotNull(mappedResponse);

        var path = "/dashboards";
        stubFor(post(urlPathTemplate(path))
                        .withHeader(AUTHORIZATION, equalTo(BEARER_TOKEN))
                        .withHeader(CONTENT_TYPE, equalTo(requestBodyContentType))
                        .withRequestBody(equalToJson(requestBodyJson))
                        .willReturn(aResponse()
                                            .withHeader(CONTENT_TYPE, responseContentType)
                                            .withBody(responseBodyJson)
                                            .withStatus(statusCode)));

        var apiResponse = api.createDashboard(mappedRequest, null);
        assertEquals(mappedResponse, apiResponse);
    }
    
    /**
     * Delete dashboard
     * <p>
     * Deletes a dashboard using the &#x60;dashboardId&#x60; provided in the request.  **Note**: * Users with the &#x60;Edit dashboard templates for all users in account group&#x60; permission (Account Admin) can delete any dashboard. * Users with the &#x60;Edit own dashboard templates&#x60; permission (Regular User) can only delete the dashboards they have created themselves. 
     *
     * @throws JsonProcessingException if the deserialization fails
     */
    @Test
    public void deleteDashboardRequestAndResponseDeserializationTest()
            throws JsonProcessingException, ApiException
    {
        String dashboardId = "646f4d2ce3c99b0536c3821e";


        var statusCode = 204;

        var path = "/dashboards/{dashboardId}";
        stubFor(delete(urlPathTemplate(path))
                        .withPathParam("dashboardId", equalTo(URLEncoder.encode(dashboardId, StandardCharsets.UTF_8)))
                        .withHeader(AUTHORIZATION, equalTo(BEARER_TOKEN))
                        .willReturn(aResponse()
                                            .withStatus(statusCode)));

        var apiResponse = api.deleteDashboardWithHttpInfo(dashboardId, null);
        assertEquals(statusCode, apiResponse.getStatusCode());
    }
    
    /**
     * Retrieve dashboard
     * <p>
     * Returns a list of widgets within a dashboard, along with the dashboard&#39;s metadata. 
     *
     * @throws JsonProcessingException if the deserialization fails
     */
    @Test
    public void getDashboardRequestAndResponseDeserializationTest()
            throws JsonProcessingException, ApiException
    {
        String dashboardId = "646f4d2ce3c99b0536c3821e";


        var responseBodyJson = """
                {
                  "isMigratedReport" : false,
                  "dashboardCreatedBy" : "1",
                  "_links" : {
                    "snapshots" : {
                      "hreflang" : "hreflang",
                      "templated" : true,
                      "profile" : "profile",
                      "name" : "name",
                      "href" : "https://api.thousandeyes.com/v7/link/to/resource/id",
                      "type" : "type",
                      "deprecation" : "deprecation",
                      "title" : "title"
                    },
                    "self" : {
                      "hreflang" : "hreflang",
                      "templated" : true,
                      "profile" : "profile",
                      "name" : "name",
                      "href" : "https://api.thousandeyes.com/v7/link/to/resource/id",
                      "type" : "type",
                      "deprecation" : "deprecation",
                      "title" : "title"
                    }
                  },
                  "dashboardModifiedBy" : "1",
                  "migratedReport" : false,
                  "isDefaultForAccount" : false,
                  "isDefaultForUser" : true,
                  "description" : "HTTP Server Widgets",
                  "isPrivate" : true,
                  "title" : "HTTP Server Widgets",
                  "isBuiltIn" : true,
                  "widgets" : [ {
                    "embedUrl" : "https://embed.thousandeyes.com/e/00aa:3039802d-5c76-42d2-9a93-c6e5f9d3122f",
                    "shouldExcludeAlertSuppressionWindows" : true,
                    "_links" : {
                      "self" : {
                        "hreflang" : "hreflang",
                        "templated" : true,
                        "profile" : "profile",
                        "name" : "name",
                        "href" : "https://api.thousandeyes.com/v7/link/to/resource/id",
                        "type" : "type",
                        "deprecation" : "deprecation",
                        "title" : "title"
                      }
                    },
                    "visualMode" : "Full",
                    "filters" : {
                      "TEST" : [ 5187, 5227 ],
                      "ENDPOINT_MACHINE_ID" : [ "fbd0050c-07f7-43f7-9631-14b32f096962" ]
                    },
                    "title" : "Widget Title",
                    "type" : "Agent Status",
                    "metricGroup" : "BGP",
                    "measure" : {
                      "percentileValue" : 95.0,
                      "type" : "MEAN"
                    },
                    "apiLink" : "apiLink",
                    "metric" : "ENDPOINT_GATEWAY_CPU_LOAD_PERCENT",
                    "isEmbedded" : true,
                    "id" : "1234",
                    "fixedTimespan" : {
                      "unit" : "Days",
                      "value" : 10
                    },
                    "dataSource" : "ENDPOINT_AGENTS",
                    "direction" : "FROM_TARGET"
                  }, {
                    "embedUrl" : "https://embed.thousandeyes.com/e/00aa:3039802d-5c76-42d2-9a93-c6e5f9d3122f",
                    "shouldExcludeAlertSuppressionWindows" : true,
                    "_links" : {
                      "self" : {
                        "hreflang" : "hreflang",
                        "templated" : true,
                        "profile" : "profile",
                        "name" : "name",
                        "href" : "https://api.thousandeyes.com/v7/link/to/resource/id",
                        "type" : "type",
                        "deprecation" : "deprecation",
                        "title" : "title"
                      }
                    },
                    "visualMode" : "Full",
                    "filters" : {
                      "TEST" : [ 5187, 5227 ],
                      "ENDPOINT_MACHINE_ID" : [ "fbd0050c-07f7-43f7-9631-14b32f096962" ]
                    },
                    "title" : "Widget Title",
                    "type" : "Agent Status",
                    "metricGroup" : "BGP",
                    "measure" : {
                      "percentileValue" : 95.0,
                      "type" : "MEAN"
                    },
                    "apiLink" : "apiLink",
                    "metric" : "ENDPOINT_GATEWAY_CPU_LOAD_PERCENT",
                    "isEmbedded" : true,
                    "id" : "1234",
                    "fixedTimespan" : {
                      "unit" : "Days",
                      "value" : 10
                    },
                    "dataSource" : "ENDPOINT_AGENTS",
                    "direction" : "FROM_TARGET"
                  } ],
                  "defaultTimespan" : {
                    "duration" : 7200,
                    "timespanDuration" : 7200,
                    "start" : "2023-05-16T10:14:28Z",
                    "end" : "2023-05-16T11:14:28Z",
                    "timespanStart" : "2023-05-16 10:14:28",
                    "timespanEnd" : "2023-05-16 11:14:28"
                  },
                  "globalFilterId" : "65babd9bb90bf55b17c96c8d",
                  "accountId" : 1234,
                  "apiLink" : [ {
                    "key" : ""
                  }, {
                    "key" : ""
                  } ],
                  "dashboardId" : "5e1f7a99143ae6004fdc3bb4",
                  "createdBy" : 1,
                  "globalOverride" : true,
                  "modifiedDate" : "2023-05-16 10:14:28",
                  "modifiedBy" : 1,
                  "isGlobalOverride" : true,
                  "aid" : "1234",
                  "dashboardModifiedDate" : "2023-05-16T10:14:28Z"
                }
                                  """;
        var statusCode = 200;
        var responseContentType = "application/json";
        ApiDashboard mappedResponse = 
                mapper.readValue(responseBodyJson, ApiDashboard.class);
        assertNotNull(mappedResponse);

        var path = "/dashboards/{dashboardId}";
        stubFor(get(urlPathTemplate(path))
                        .withPathParam("dashboardId", equalTo(URLEncoder.encode(dashboardId, StandardCharsets.UTF_8)))
                        .withHeader(AUTHORIZATION, equalTo(BEARER_TOKEN))
                        .willReturn(aResponse()
                                            .withHeader(CONTENT_TYPE, responseContentType)
                                            .withBody(responseBodyJson)
                                            .withStatus(statusCode)));

        var apiResponse = api.getDashboard(dashboardId, null);
        assertEquals(mappedResponse, apiResponse);
    }
    
    /**
     * Retrieve dashboard widget data
     * <p>
     * Returns the raw data displayed within a widget in the dashboard. 
     *
     * @throws JsonProcessingException if the deserialization fails
     */
    @Test
    public void getDashboardWidgetDataRequestAndResponseDeserializationTest()
            throws JsonProcessingException, ApiException
    {
        String dashboardId = "646f4d2ce3c99b0536c3821e";
        String widgetId = "unpmg";


        var responseBodyJson = """
                {
                  "groupLabels" : [ {
                    "groupProperty" : "AGENT",
                    "groupLabels" : [ {
                      "groupId" : "2565",
                      "groupLabel" : "San Francisco, CA"
                    }, {
                      "groupId" : "2565",
                      "groupLabel" : "San Francisco, CA"
                    } ]
                  }, {
                    "groupProperty" : "AGENT",
                    "groupLabels" : [ {
                      "groupId" : "2565",
                      "groupLabel" : "San Francisco, CA"
                    }, {
                      "groupId" : "2565",
                      "groupLabel" : "San Francisco, CA"
                    } ]
                  } ],
                  "data" : {
                    "alerts" : [ {
                      "alertType" : "network-end-to-end-server",
                      "durationInSeconds" : 25,
                      "alertSource" : "Http Test",
                      "active" : true,
                      "testId" : "56512",
                      "startTime" : "2023-06-02T08:54:00Z",
                      "alertId" : "2004945",
                      "ruleId" : "281724",
                      "alertRule" : "Http Test Rule"
                    }, {
                      "alertType" : "network-end-to-end-server",
                      "durationInSeconds" : 25,
                      "alertSource" : "Http Test",
                      "active" : true,
                      "testId" : "56512",
                      "startTime" : "2023-06-02T08:54:00Z",
                      "alertId" : "2004945",
                      "ruleId" : "281724",
                      "alertRule" : "Http Test Rule"
                    } ],
                    "summary" : {
                      "offline" : 2,
                      "online" : 10,
                      "disabled" : 3
                    },
                    "totalAlerts" : 500,
                    "cards" : [ {
                      "numberOfDataPoints" : 24192,
                      "endDate" : "2023-05-16T10:14:28Z",
                      "_links" : {
                        "self" : {
                          "hreflang" : "hreflang",
                          "templated" : true,
                          "profile" : "profile",
                          "name" : "name",
                          "href" : "https://api.thousandeyes.com/v7/link/to/resource/id",
                          "type" : "type",
                          "deprecation" : "deprecation",
                          "title" : "title"
                        }
                      },
                      "cardId" : "lrxxr",
                      "alertSuppressionWindows" : [ {
                        "testIds" : [ "281474976710661" ],
                        "repeatUnit" : "week",
                        "durationInSeconds" : 7200,
                        "repeat" : "custom",
                        "name" : "Test dashboards",
                        "repeatEvery" : 5,
                        "id" : "281474976710662",
                        "startTimes" : [ "2023-05-16T10:14:28Z" ]
                      }, {
                        "testIds" : [ "281474976710661" ],
                        "repeatUnit" : "week",
                        "durationInSeconds" : 7200,
                        "repeat" : "custom",
                        "name" : "Test dashboards",
                        "repeatEvery" : 5,
                        "id" : "281474976710662",
                        "startTimes" : [ "2023-05-16T10:14:28Z" ]
                      } ],
                      "binSize" : 3600,
                      "previousValue" : 500.0,
                      "value" : 100.0,
                      "startDate" : "2023-05-16T10:14:28Z",
                      "timestamp" : 1567620000,
                      "status" : "No data"
                    }, {
                      "numberOfDataPoints" : 24192,
                      "endDate" : "2023-05-16T10:14:28Z",
                      "_links" : {
                        "self" : {
                          "hreflang" : "hreflang",
                          "templated" : true,
                          "profile" : "profile",
                          "name" : "name",
                          "href" : "https://api.thousandeyes.com/v7/link/to/resource/id",
                          "type" : "type",
                          "deprecation" : "deprecation",
                          "title" : "title"
                        }
                      },
                      "cardId" : "lrxxr",
                      "alertSuppressionWindows" : [ {
                        "testIds" : [ "281474976710661" ],
                        "repeatUnit" : "week",
                        "durationInSeconds" : 7200,
                        "repeat" : "custom",
                        "name" : "Test dashboards",
                        "repeatEvery" : 5,
                        "id" : "281474976710662",
                        "startTimes" : [ "2023-05-16T10:14:28Z" ]
                      }, {
                        "testIds" : [ "281474976710661" ],
                        "repeatUnit" : "week",
                        "durationInSeconds" : 7200,
                        "repeat" : "custom",
                        "name" : "Test dashboards",
                        "repeatEvery" : 5,
                        "id" : "281474976710662",
                        "startTimes" : [ "2023-05-16T10:14:28Z" ]
                      } ],
                      "binSize" : 3600,
                      "previousValue" : 500.0,
                      "value" : 100.0,
                      "startDate" : "2023-05-16T10:14:28Z",
                      "timestamp" : 1567620000,
                      "status" : "No data"
                    } ],
                    "tests" : [ {
                      "graphlets" : [ {
                        "metric" : "Availability",
                        "testId" : "68257",
                        "points" : [ {
                          "x" : 1580403900,
                          "y" : 128.249
                        }, {
                          "x" : 1580403900,
                          "y" : 128.249
                        } ]
                      }, {
                        "metric" : "Availability",
                        "testId" : "68257",
                        "points" : [ {
                          "x" : 1580403900,
                          "y" : 128.249
                        }, {
                          "x" : 1580403900,
                          "y" : 128.249
                        } ]
                      } ],
                      "alertCount" : 398,
                      "testType" : "Web - HTTP Server",
                      "testId" : "68256",
                      "isShared" : true,
                      "testName" : "Http Test Name",
                      "target" : "www.google.com"
                    }, {
                      "graphlets" : [ {
                        "metric" : "Availability",
                        "testId" : "68257",
                        "points" : [ {
                          "x" : 1580403900,
                          "y" : 128.249
                        }, {
                          "x" : 1580403900,
                          "y" : 128.249
                        } ]
                      }, {
                        "metric" : "Availability",
                        "testId" : "68257",
                        "points" : [ {
                          "x" : 1580403900,
                          "y" : 128.249
                        }, {
                          "x" : 1580403900,
                          "y" : 128.249
                        } ]
                      } ],
                      "alertCount" : 398,
                      "testType" : "Web - HTTP Server",
                      "testId" : "68256",
                      "isShared" : true,
                      "testName" : "Http Test Name",
                      "target" : "www.google.com"
                    } ],
                    "columns" : [ {
                      "_links" : {
                        "self" : {
                          "hreflang" : "hreflang",
                          "templated" : true,
                          "profile" : "profile",
                          "name" : "name",
                          "href" : "https://api.thousandeyes.com/v7/link/to/resource/id",
                          "type" : "type",
                          "deprecation" : "deprecation",
                          "title" : "title"
                        }
                      },
                      "columnId" : "938to",
                      "alertSuppressionWindows" : [ {
                        "testIds" : [ "281474976710661" ],
                        "repeatUnit" : "week",
                        "durationInSeconds" : 7200,
                        "repeat" : "custom",
                        "name" : "Test dashboards",
                        "repeatEvery" : 5,
                        "id" : "281474976710662",
                        "startTimes" : [ "2023-05-16T10:14:28Z" ]
                      }, {
                        "testIds" : [ "281474976710661" ],
                        "repeatUnit" : "week",
                        "durationInSeconds" : 7200,
                        "repeat" : "custom",
                        "name" : "Test dashboards",
                        "repeatEvery" : 5,
                        "id" : "281474976710662",
                        "startTimes" : [ "2023-05-16T10:14:28Z" ]
                      } ],
                      "binSize" : 3600,
                      "points" : [ {
                        "numberOfDataPoints" : 23304,
                        "groups" : [ {
                          "groupProperty" : "COUNTRY",
                          "groupValue" : "US"
                        }, {
                          "groupProperty" : "COUNTRY",
                          "groupValue" : "US"
                        } ],
                        "value" : 100.0,
                        "timestamp" : 1567620000
                      }, {
                        "numberOfDataPoints" : 23304,
                        "groups" : [ {
                          "groupProperty" : "COUNTRY",
                          "groupValue" : "US"
                        }, {
                          "groupProperty" : "COUNTRY",
                          "groupValue" : "US"
                        } ],
                        "value" : 100.0,
                        "timestamp" : 1567620000
                      } ],
                      "status" : "No data"
                    }, {
                      "_links" : {
                        "self" : {
                          "hreflang" : "hreflang",
                          "templated" : true,
                          "profile" : "profile",
                          "name" : "name",
                          "href" : "https://api.thousandeyes.com/v7/link/to/resource/id",
                          "type" : "type",
                          "deprecation" : "deprecation",
                          "title" : "title"
                        }
                      },
                      "columnId" : "938to",
                      "alertSuppressionWindows" : [ {
                        "testIds" : [ "281474976710661" ],
                        "repeatUnit" : "week",
                        "durationInSeconds" : 7200,
                        "repeat" : "custom",
                        "name" : "Test dashboards",
                        "repeatEvery" : 5,
                        "id" : "281474976710662",
                        "startTimes" : [ "2023-05-16T10:14:28Z" ]
                      }, {
                        "testIds" : [ "281474976710661" ],
                        "repeatUnit" : "week",
                        "durationInSeconds" : 7200,
                        "repeat" : "custom",
                        "name" : "Test dashboards",
                        "repeatEvery" : 5,
                        "id" : "281474976710662",
                        "startTimes" : [ "2023-05-16T10:14:28Z" ]
                      } ],
                      "binSize" : 3600,
                      "points" : [ {
                        "numberOfDataPoints" : 23304,
                        "groups" : [ {
                          "groupProperty" : "COUNTRY",
                          "groupValue" : "US"
                        }, {
                          "groupProperty" : "COUNTRY",
                          "groupValue" : "US"
                        } ],
                        "value" : 100.0,
                        "timestamp" : 1567620000
                      }, {
                        "numberOfDataPoints" : 23304,
                        "groups" : [ {
                          "groupProperty" : "COUNTRY",
                          "groupValue" : "US"
                        }, {
                          "groupProperty" : "COUNTRY",
                          "groupValue" : "US"
                        } ],
                        "value" : 100.0,
                        "timestamp" : 1567620000
                      } ],
                      "status" : "No data"
                    } ],
                    "alertSuppressionWindows" : [ {
                      "testIds" : [ "281474976710661" ],
                      "repeatUnit" : "week",
                      "durationInSeconds" : 7200,
                      "repeat" : "custom",
                      "name" : "Test dashboards",
                      "repeatEvery" : 5,
                      "id" : "281474976710662",
                      "startTimes" : [ "2023-05-16T10:14:28Z" ]
                    }, {
                      "testIds" : [ "281474976710661" ],
                      "repeatUnit" : "week",
                      "durationInSeconds" : 7200,
                      "repeat" : "custom",
                      "name" : "Test dashboards",
                      "repeatEvery" : 5,
                      "id" : "281474976710662",
                      "startTimes" : [ "2023-05-16T10:14:28Z" ]
                    } ],
                    "activeAlerts" : 483,
                    "startRound" : 1384309800,
                    "points" : [ {
                      "numberOfDataPoints" : 23304,
                      "groups" : [ {
                        "groupProperty" : "COUNTRY",
                        "groupValue" : "US"
                      }, {
                        "groupProperty" : "COUNTRY",
                        "groupValue" : "US"
                      } ],
                      "value" : 100.0,
                      "timestamp" : 1567620000
                    }, {
                      "numberOfDataPoints" : 23304,
                      "groups" : [ {
                        "groupProperty" : "COUNTRY",
                        "groupValue" : "US"
                      }, {
                        "groupProperty" : "COUNTRY",
                        "groupValue" : "US"
                      } ],
                      "value" : 100.0,
                      "timestamp" : 1567620000
                    } ],
                    "agents" : [ {
                      "agentId" : "6522",
                      "agentName" : "0c3898000117",
                      "location" : {
                        "locationName" : "San Francisco, California, US",
                        "latitude" : 37.77493,
                        "longitude" : -122.41942
                      },
                      "ipInfo" : {
                        "ipv6" : "ipv6",
                        "privateIp" : "172.58.92.31",
                        "operativeSystemVersion" : "operativeSystemVersion",
                        "publicIp" : "172.58.92.31"
                      },
                      "status" : "online"
                    }, {
                      "agentId" : "6522",
                      "agentName" : "0c3898000117",
                      "location" : {
                        "locationName" : "San Francisco, California, US",
                        "latitude" : 37.77493,
                        "longitude" : -122.41942
                      },
                      "ipInfo" : {
                        "ipv6" : "ipv6",
                        "privateIp" : "172.58.92.31",
                        "operativeSystemVersion" : "operativeSystemVersion",
                        "publicIp" : "172.58.92.31"
                      },
                      "status" : "online"
                    } ],
                    "status" : "No data"
                  },
                  "endDate" : "2022-07-18T22:00:54Z",
                  "_links" : {
                    "next" : {
                      "hreflang" : "hreflang",
                      "templated" : true,
                      "profile" : "profile",
                      "name" : "name",
                      "href" : "https://api.thousandeyes.com/v7/link/to/resource/id",
                      "type" : "type",
                      "deprecation" : "deprecation",
                      "title" : "title"
                    },
                    "previous" : {
                      "hreflang" : "hreflang",
                      "templated" : true,
                      "profile" : "profile",
                      "name" : "name",
                      "href" : "https://api.thousandeyes.com/v7/link/to/resource/id",
                      "type" : "type",
                      "deprecation" : "deprecation",
                      "title" : "title"
                    },
                    "self" : {
                      "hreflang" : "hreflang",
                      "templated" : true,
                      "profile" : "profile",
                      "name" : "name",
                      "href" : "https://api.thousandeyes.com/v7/link/to/resource/id",
                      "type" : "type",
                      "deprecation" : "deprecation",
                      "title" : "title"
                    }
                  },
                  "binSize" : 3600,
                  "startDate" : "2022-07-17T22:00:54Z"
                }
                                  """;
        var statusCode = 200;
        var responseContentType = "application/json";
        ApiWidgetDataResponse mappedResponse = 
                mapper.readValue(responseBodyJson, ApiWidgetDataResponse.class);
        assertNotNull(mappedResponse);

        var path = "/dashboards/{dashboardId}/widgets/{widgetId}";
        stubFor(get(urlPathTemplate(path))
                        .withPathParam("dashboardId", equalTo(URLEncoder.encode(dashboardId, StandardCharsets.UTF_8)))
                        .withPathParam("widgetId", equalTo(URLEncoder.encode(widgetId, StandardCharsets.UTF_8)))
                        .withHeader(AUTHORIZATION, equalTo(BEARER_TOKEN))
                        .willReturn(aResponse()
                                            .withHeader(CONTENT_TYPE, responseContentType)
                                            .withBody(responseBodyJson)
                                            .withStatus(statusCode)));

        var apiResponse = api.getDashboardWidgetData(dashboardId, widgetId, null, null, null, null, null, null, null, null);
        assertEquals(mappedResponse, apiResponse);
    }
    
    /**
     * List dashboards
     * <p>
     * Returns a list of dashboards and their settings within your account group. 
     *
     * @throws JsonProcessingException if the deserialization fails
     */
    @Test
    public void getDashboardsRequestAndResponseDeserializationTest()
            throws JsonProcessingException, ApiException
    {


        var responseBodyJson = """
                [ {
                  "isMigratedReport" : false,
                  "dashboardCreatedBy" : "1",
                  "_links" : {
                    "snapshots" : {
                      "hreflang" : "hreflang",
                      "templated" : true,
                      "profile" : "profile",
                      "name" : "name",
                      "href" : "https://api.thousandeyes.com/v7/link/to/resource/id",
                      "type" : "type",
                      "deprecation" : "deprecation",
                      "title" : "title"
                    },
                    "self" : {
                      "hreflang" : "hreflang",
                      "templated" : true,
                      "profile" : "profile",
                      "name" : "name",
                      "href" : "https://api.thousandeyes.com/v7/link/to/resource/id",
                      "type" : "type",
                      "deprecation" : "deprecation",
                      "title" : "title"
                    }
                  },
                  "dashboardModifiedBy" : "1",
                  "migratedReport" : false,
                  "isDefaultForAccount" : false,
                  "isDefaultForUser" : true,
                  "description" : "HTTP Server Widgets",
                  "isPrivate" : true,
                  "title" : "HTTP Server Widgets",
                  "isBuiltIn" : true,
                  "widgets" : [ {
                    "embedUrl" : "https://embed.thousandeyes.com/e/00aa:3039802d-5c76-42d2-9a93-c6e5f9d3122f",
                    "shouldExcludeAlertSuppressionWindows" : true,
                    "_links" : {
                      "self" : {
                        "hreflang" : "hreflang",
                        "templated" : true,
                        "profile" : "profile",
                        "name" : "name",
                        "href" : "https://api.thousandeyes.com/v7/link/to/resource/id",
                        "type" : "type",
                        "deprecation" : "deprecation",
                        "title" : "title"
                      }
                    },
                    "visualMode" : "Full",
                    "filters" : {
                      "TEST" : [ 5187, 5227 ],
                      "ENDPOINT_MACHINE_ID" : [ "fbd0050c-07f7-43f7-9631-14b32f096962" ]
                    },
                    "title" : "Widget Title",
                    "type" : "Agent Status",
                    "metricGroup" : "BGP",
                    "measure" : {
                      "percentileValue" : 95.0,
                      "type" : "MEAN"
                    },
                    "apiLink" : "apiLink",
                    "metric" : "ENDPOINT_GATEWAY_CPU_LOAD_PERCENT",
                    "isEmbedded" : true,
                    "id" : "1234",
                    "fixedTimespan" : {
                      "unit" : "Days",
                      "value" : 10
                    },
                    "dataSource" : "ENDPOINT_AGENTS",
                    "direction" : "FROM_TARGET"
                  }, {
                    "embedUrl" : "https://embed.thousandeyes.com/e/00aa:3039802d-5c76-42d2-9a93-c6e5f9d3122f",
                    "shouldExcludeAlertSuppressionWindows" : true,
                    "_links" : {
                      "self" : {
                        "hreflang" : "hreflang",
                        "templated" : true,
                        "profile" : "profile",
                        "name" : "name",
                        "href" : "https://api.thousandeyes.com/v7/link/to/resource/id",
                        "type" : "type",
                        "deprecation" : "deprecation",
                        "title" : "title"
                      }
                    },
                    "visualMode" : "Full",
                    "filters" : {
                      "TEST" : [ 5187, 5227 ],
                      "ENDPOINT_MACHINE_ID" : [ "fbd0050c-07f7-43f7-9631-14b32f096962" ]
                    },
                    "title" : "Widget Title",
                    "type" : "Agent Status",
                    "metricGroup" : "BGP",
                    "measure" : {
                      "percentileValue" : 95.0,
                      "type" : "MEAN"
                    },
                    "apiLink" : "apiLink",
                    "metric" : "ENDPOINT_GATEWAY_CPU_LOAD_PERCENT",
                    "isEmbedded" : true,
                    "id" : "1234",
                    "fixedTimespan" : {
                      "unit" : "Days",
                      "value" : 10
                    },
                    "dataSource" : "ENDPOINT_AGENTS",
                    "direction" : "FROM_TARGET"
                  } ],
                  "defaultTimespan" : {
                    "duration" : 7200,
                    "timespanDuration" : 7200,
                    "start" : "2023-05-16T10:14:28Z",
                    "end" : "2023-05-16T11:14:28Z",
                    "timespanStart" : "2023-05-16 10:14:28",
                    "timespanEnd" : "2023-05-16 11:14:28"
                  },
                  "globalFilterId" : "65babd9bb90bf55b17c96c8d",
                  "accountId" : 1234,
                  "apiLink" : [ {
                    "key" : ""
                  }, {
                    "key" : ""
                  } ],
                  "dashboardId" : "5e1f7a99143ae6004fdc3bb4",
                  "createdBy" : 1,
                  "globalOverride" : true,
                  "modifiedDate" : "2023-05-16 10:14:28",
                  "modifiedBy" : 1,
                  "isGlobalOverride" : true,
                  "aid" : "1234",
                  "dashboardModifiedDate" : "2023-05-16T10:14:28Z"
                }, {
                  "isMigratedReport" : false,
                  "dashboardCreatedBy" : "1",
                  "_links" : {
                    "snapshots" : {
                      "hreflang" : "hreflang",
                      "templated" : true,
                      "profile" : "profile",
                      "name" : "name",
                      "href" : "https://api.thousandeyes.com/v7/link/to/resource/id",
                      "type" : "type",
                      "deprecation" : "deprecation",
                      "title" : "title"
                    },
                    "self" : {
                      "hreflang" : "hreflang",
                      "templated" : true,
                      "profile" : "profile",
                      "name" : "name",
                      "href" : "https://api.thousandeyes.com/v7/link/to/resource/id",
                      "type" : "type",
                      "deprecation" : "deprecation",
                      "title" : "title"
                    }
                  },
                  "dashboardModifiedBy" : "1",
                  "migratedReport" : false,
                  "isDefaultForAccount" : false,
                  "isDefaultForUser" : true,
                  "description" : "HTTP Server Widgets",
                  "isPrivate" : true,
                  "title" : "HTTP Server Widgets",
                  "isBuiltIn" : true,
                  "widgets" : [ {
                    "embedUrl" : "https://embed.thousandeyes.com/e/00aa:3039802d-5c76-42d2-9a93-c6e5f9d3122f",
                    "shouldExcludeAlertSuppressionWindows" : true,
                    "_links" : {
                      "self" : {
                        "hreflang" : "hreflang",
                        "templated" : true,
                        "profile" : "profile",
                        "name" : "name",
                        "href" : "https://api.thousandeyes.com/v7/link/to/resource/id",
                        "type" : "type",
                        "deprecation" : "deprecation",
                        "title" : "title"
                      }
                    },
                    "visualMode" : "Full",
                    "filters" : {
                      "TEST" : [ 5187, 5227 ],
                      "ENDPOINT_MACHINE_ID" : [ "fbd0050c-07f7-43f7-9631-14b32f096962" ]
                    },
                    "title" : "Widget Title",
                    "type" : "Agent Status",
                    "metricGroup" : "BGP",
                    "measure" : {
                      "percentileValue" : 95.0,
                      "type" : "MEAN"
                    },
                    "apiLink" : "apiLink",
                    "metric" : "ENDPOINT_GATEWAY_CPU_LOAD_PERCENT",
                    "isEmbedded" : true,
                    "id" : "1234",
                    "fixedTimespan" : {
                      "unit" : "Days",
                      "value" : 10
                    },
                    "dataSource" : "ENDPOINT_AGENTS",
                    "direction" : "FROM_TARGET"
                  }, {
                    "embedUrl" : "https://embed.thousandeyes.com/e/00aa:3039802d-5c76-42d2-9a93-c6e5f9d3122f",
                    "shouldExcludeAlertSuppressionWindows" : true,
                    "_links" : {
                      "self" : {
                        "hreflang" : "hreflang",
                        "templated" : true,
                        "profile" : "profile",
                        "name" : "name",
                        "href" : "https://api.thousandeyes.com/v7/link/to/resource/id",
                        "type" : "type",
                        "deprecation" : "deprecation",
                        "title" : "title"
                      }
                    },
                    "visualMode" : "Full",
                    "filters" : {
                      "TEST" : [ 5187, 5227 ],
                      "ENDPOINT_MACHINE_ID" : [ "fbd0050c-07f7-43f7-9631-14b32f096962" ]
                    },
                    "title" : "Widget Title",
                    "type" : "Agent Status",
                    "metricGroup" : "BGP",
                    "measure" : {
                      "percentileValue" : 95.0,
                      "type" : "MEAN"
                    },
                    "apiLink" : "apiLink",
                    "metric" : "ENDPOINT_GATEWAY_CPU_LOAD_PERCENT",
                    "isEmbedded" : true,
                    "id" : "1234",
                    "fixedTimespan" : {
                      "unit" : "Days",
                      "value" : 10
                    },
                    "dataSource" : "ENDPOINT_AGENTS",
                    "direction" : "FROM_TARGET"
                  } ],
                  "defaultTimespan" : {
                    "duration" : 7200,
                    "timespanDuration" : 7200,
                    "start" : "2023-05-16T10:14:28Z",
                    "end" : "2023-05-16T11:14:28Z",
                    "timespanStart" : "2023-05-16 10:14:28",
                    "timespanEnd" : "2023-05-16 11:14:28"
                  },
                  "globalFilterId" : "65babd9bb90bf55b17c96c8d",
                  "accountId" : 1234,
                  "apiLink" : [ {
                    "key" : ""
                  }, {
                    "key" : ""
                  } ],
                  "dashboardId" : "5e1f7a99143ae6004fdc3bb4",
                  "createdBy" : 1,
                  "globalOverride" : true,
                  "modifiedDate" : "2023-05-16 10:14:28",
                  "modifiedBy" : 1,
                  "isGlobalOverride" : true,
                  "aid" : "1234",
                  "dashboardModifiedDate" : "2023-05-16T10:14:28Z"
                } ]
                                  """;
        var statusCode = 200;
        var responseContentType = "application/json";
        List<ApiDashboard> mappedResponse = 
                mapper.readValue(responseBodyJson, new TypeReference<List<ApiDashboard>>(){});
        assertNotNull(mappedResponse);

        var path = "/dashboards";
        stubFor(get(urlPathTemplate(path))
                        .withHeader(AUTHORIZATION, equalTo(BEARER_TOKEN))
                        .willReturn(aResponse()
                                            .withHeader(CONTENT_TYPE, responseContentType)
                                            .withBody(responseBodyJson)
                                            .withStatus(statusCode)));

        var apiResponse = api.getDashboards(null);
        assertEquals(mappedResponse, apiResponse);
    }
    
    /**
     * Retrieve individual card data from numbers widget
     * <p>
     * Returns the raw data for an individual card within a numbers widget in the dashboard. 
     *
     * @throws JsonProcessingException if the deserialization fails
     */
    @Test
    public void getIndividualCardDataRequestAndResponseDeserializationTest()
            throws JsonProcessingException, ApiException
    {
        String dashboardId = "646f4d2ce3c99b0536c3821e";
        String widgetId = "unpmg";
        String cardId = "rvwgs";


        var responseBodyJson = """
                {
                  "numberOfDataPoints" : 24192,
                  "endDate" : "2023-05-16T10:14:28Z",
                  "_links" : {
                    "self" : {
                      "hreflang" : "hreflang",
                      "templated" : true,
                      "profile" : "profile",
                      "name" : "name",
                      "href" : "https://api.thousandeyes.com/v7/link/to/resource/id",
                      "type" : "type",
                      "deprecation" : "deprecation",
                      "title" : "title"
                    }
                  },
                  "cardId" : "lrxxr",
                  "alertSuppressionWindows" : [ {
                    "testIds" : [ "281474976710661" ],
                    "repeatUnit" : "week",
                    "durationInSeconds" : 7200,
                    "repeat" : "custom",
                    "name" : "Test dashboards",
                    "repeatEvery" : 5,
                    "id" : "281474976710662",
                    "startTimes" : [ "2023-05-16T10:14:28Z" ]
                  }, {
                    "testIds" : [ "281474976710661" ],
                    "repeatUnit" : "week",
                    "durationInSeconds" : 7200,
                    "repeat" : "custom",
                    "name" : "Test dashboards",
                    "repeatEvery" : 5,
                    "id" : "281474976710662",
                    "startTimes" : [ "2023-05-16T10:14:28Z" ]
                  } ],
                  "binSize" : 3600,
                  "previousValue" : 500.0,
                  "value" : 100.0,
                  "startDate" : "2023-05-16T10:14:28Z",
                  "timestamp" : 1567620000,
                  "status" : "No data"
                }
                                  """;
        var statusCode = 200;
        var responseContentType = "application/json";
        ApiNumbersCardData mappedResponse = 
                mapper.readValue(responseBodyJson, ApiNumbersCardData.class);
        assertNotNull(mappedResponse);

        var path = "/dashboards/{dashboardId}/widgets/{widgetId}/cards/{cardId}";
        stubFor(get(urlPathTemplate(path))
                        .withPathParam("dashboardId", equalTo(URLEncoder.encode(dashboardId, StandardCharsets.UTF_8)))
                        .withPathParam("widgetId", equalTo(URLEncoder.encode(widgetId, StandardCharsets.UTF_8)))
                        .withPathParam("cardId", equalTo(URLEncoder.encode(cardId, StandardCharsets.UTF_8)))
                        .withHeader(AUTHORIZATION, equalTo(BEARER_TOKEN))
                        .willReturn(aResponse()
                                            .withHeader(CONTENT_TYPE, responseContentType)
                                            .withBody(responseBodyJson)
                                            .withStatus(statusCode)));

        var apiResponse = api.getIndividualCardData(dashboardId, widgetId, cardId, null, null, null, null);
        assertEquals(mappedResponse, apiResponse);
    }
    
    /**
     * Retrieve individual column data from multi-metric table widget
     * <p>
     * Returns the raw data for an individual column within a multi-metric table widget in the dashboard. 
     *
     * @throws JsonProcessingException if the deserialization fails
     */
    @Test
    public void getIndividualColumnDataRequestAndResponseDeserializationTest()
            throws JsonProcessingException, ApiException
    {
        String dashboardId = "646f4d2ce3c99b0536c3821e";
        String widgetId = "unpmg";
        String columnId = "col123";


        var responseBodyJson = """
                {
                  "_links" : {
                    "self" : {
                      "hreflang" : "hreflang",
                      "templated" : true,
                      "profile" : "profile",
                      "name" : "name",
                      "href" : "https://api.thousandeyes.com/v7/link/to/resource/id",
                      "type" : "type",
                      "deprecation" : "deprecation",
                      "title" : "title"
                    }
                  },
                  "columnId" : "938to",
                  "alertSuppressionWindows" : [ {
                    "testIds" : [ "281474976710661" ],
                    "repeatUnit" : "week",
                    "durationInSeconds" : 7200,
                    "repeat" : "custom",
                    "name" : "Test dashboards",
                    "repeatEvery" : 5,
                    "id" : "281474976710662",
                    "startTimes" : [ "2023-05-16T10:14:28Z" ]
                  }, {
                    "testIds" : [ "281474976710661" ],
                    "repeatUnit" : "week",
                    "durationInSeconds" : 7200,
                    "repeat" : "custom",
                    "name" : "Test dashboards",
                    "repeatEvery" : 5,
                    "id" : "281474976710662",
                    "startTimes" : [ "2023-05-16T10:14:28Z" ]
                  } ],
                  "binSize" : 3600,
                  "points" : [ {
                    "numberOfDataPoints" : 23304,
                    "groups" : [ {
                      "groupProperty" : "COUNTRY",
                      "groupValue" : "US"
                    }, {
                      "groupProperty" : "COUNTRY",
                      "groupValue" : "US"
                    } ],
                    "value" : 100.0,
                    "timestamp" : 1567620000
                  }, {
                    "numberOfDataPoints" : 23304,
                    "groups" : [ {
                      "groupProperty" : "COUNTRY",
                      "groupValue" : "US"
                    }, {
                      "groupProperty" : "COUNTRY",
                      "groupValue" : "US"
                    } ],
                    "value" : 100.0,
                    "timestamp" : 1567620000
                  } ],
                  "status" : "No data"
                }
                                  """;
        var statusCode = 200;
        var responseContentType = "application/json";
        ApiMultiMetricColumnData mappedResponse = 
                mapper.readValue(responseBodyJson, ApiMultiMetricColumnData.class);
        assertNotNull(mappedResponse);

        var path = "/dashboards/{dashboardId}/widgets/{widgetId}/columns/{columnId}";
        stubFor(get(urlPathTemplate(path))
                        .withPathParam("dashboardId", equalTo(URLEncoder.encode(dashboardId, StandardCharsets.UTF_8)))
                        .withPathParam("widgetId", equalTo(URLEncoder.encode(widgetId, StandardCharsets.UTF_8)))
                        .withPathParam("columnId", equalTo(URLEncoder.encode(columnId, StandardCharsets.UTF_8)))
                        .withHeader(AUTHORIZATION, equalTo(BEARER_TOKEN))
                        .willReturn(aResponse()
                                            .withHeader(CONTENT_TYPE, responseContentType)
                                            .withBody(responseBodyJson)
                                            .withStatus(statusCode)));

        var apiResponse = api.getIndividualColumnData(dashboardId, widgetId, columnId, null, null, null, null);
        assertEquals(mappedResponse, apiResponse);
    }
    
    /**
     * Update dashboard
     * <p>
     * Updates an existing dashboard in your account group.   **Note**:  * Users with the &#x60;Edit dashboard templates for all users in account group&#x60; permission (Account Admin) can update any dashboard. * Users with the &#x60;Edit own dashboard templates&#x60; permission (Regular User) can only update the dashboards they have created themselves. 
     *
     * @throws JsonProcessingException if the deserialization fails
     */
    @Test
    public void updateDashboardRequestAndResponseDeserializationTest()
            throws JsonProcessingException, ApiException
    {
        String dashboardId = "646f4d2ce3c99b0536c3821e";

        var requestBodyJson = """
                {
                  "isMigratedReport" : false,
                  "_links" : {
                    "snapshots" : {
                      "hreflang" : "hreflang",
                      "templated" : true,
                      "profile" : "profile",
                      "name" : "name",
                      "href" : "https://api.thousandeyes.com/v7/link/to/resource/id",
                      "type" : "type",
                      "deprecation" : "deprecation",
                      "title" : "title"
                    },
                    "self" : {
                      "hreflang" : "hreflang",
                      "templated" : true,
                      "profile" : "profile",
                      "name" : "name",
                      "href" : "https://api.thousandeyes.com/v7/link/to/resource/id",
                      "type" : "type",
                      "deprecation" : "deprecation",
                      "title" : "title"
                    }
                  },
                  "isDefaultForAccount" : false,
                  "isDefaultForUser" : true,
                  "description" : "HTTP Server Widgets",
                  "isPrivate" : true,
                  "title" : "HTTP Server Widgets",
                  "isBuiltIn" : true,
                  "widgets" : [ {
                    "embedUrl" : "https://embed.thousandeyes.com/e/00aa:3039802d-5c76-42d2-9a93-c6e5f9d3122f",
                    "shouldExcludeAlertSuppressionWindows" : true,
                    "_links" : {
                      "self" : {
                        "hreflang" : "hreflang",
                        "templated" : true,
                        "profile" : "profile",
                        "name" : "name",
                        "href" : "https://api.thousandeyes.com/v7/link/to/resource/id",
                        "type" : "type",
                        "deprecation" : "deprecation",
                        "title" : "title"
                      }
                    },
                    "visualMode" : "Full",
                    "filters" : {
                      "TEST" : [ 5187, 5227 ],
                      "ENDPOINT_MACHINE_ID" : [ "fbd0050c-07f7-43f7-9631-14b32f096962" ]
                    },
                    "title" : "Widget Title",
                    "type" : "Agent Status",
                    "metricGroup" : "BGP",
                    "measure" : {
                      "percentileValue" : 95.0,
                      "type" : "MEAN"
                    },
                    "apiLink" : "apiLink",
                    "metric" : "ENDPOINT_GATEWAY_CPU_LOAD_PERCENT",
                    "isEmbedded" : true,
                    "id" : "1234",
                    "fixedTimespan" : {
                      "unit" : "Days",
                      "value" : 10
                    },
                    "dataSource" : "ENDPOINT_AGENTS",
                    "direction" : "FROM_TARGET"
                  }, {
                    "embedUrl" : "https://embed.thousandeyes.com/e/00aa:3039802d-5c76-42d2-9a93-c6e5f9d3122f",
                    "shouldExcludeAlertSuppressionWindows" : true,
                    "_links" : {
                      "self" : {
                        "hreflang" : "hreflang",
                        "templated" : true,
                        "profile" : "profile",
                        "name" : "name",
                        "href" : "https://api.thousandeyes.com/v7/link/to/resource/id",
                        "type" : "type",
                        "deprecation" : "deprecation",
                        "title" : "title"
                      }
                    },
                    "visualMode" : "Full",
                    "filters" : {
                      "TEST" : [ 5187, 5227 ],
                      "ENDPOINT_MACHINE_ID" : [ "fbd0050c-07f7-43f7-9631-14b32f096962" ]
                    },
                    "title" : "Widget Title",
                    "type" : "Agent Status",
                    "metricGroup" : "BGP",
                    "measure" : {
                      "percentileValue" : 95.0,
                      "type" : "MEAN"
                    },
                    "apiLink" : "apiLink",
                    "metric" : "ENDPOINT_GATEWAY_CPU_LOAD_PERCENT",
                    "isEmbedded" : true,
                    "id" : "1234",
                    "fixedTimespan" : {
                      "unit" : "Days",
                      "value" : 10
                    },
                    "dataSource" : "ENDPOINT_AGENTS",
                    "direction" : "FROM_TARGET"
                  } ],
                  "defaultTimespan" : {
                    "duration" : 7200,
                    "timespanDuration" : 7200,
                    "start" : "2023-05-16T10:14:28Z",
                    "end" : "2023-05-16T11:14:28Z",
                    "timespanStart" : "2023-05-16 10:14:28",
                    "timespanEnd" : "2023-05-16 11:14:28"
                  },
                  "globalFilterId" : "65babd9bb90bf55b17c96c8d",
                  "dashboardId" : "5e1f7a99143ae6004fdc3bb4",
                  "createdBy" : "1",
                  "modifiedDate" : "2023-05-16T10:14:28Z",
                  "modifiedBy" : "1",
                  "isGlobalOverride" : true,
                  "aid" : "1234"
                }
                                 """;
        var requestBodyContentType = "application/json";
        Dashboard mappedRequest = 
                mapper.readValue(requestBodyJson, Dashboard.class);
        assertNotNull(mappedRequest);

        var responseBodyJson = """
                {
                  "isMigratedReport" : false,
                  "_links" : {
                    "snapshots" : {
                      "hreflang" : "hreflang",
                      "templated" : true,
                      "profile" : "profile",
                      "name" : "name",
                      "href" : "https://api.thousandeyes.com/v7/link/to/resource/id",
                      "type" : "type",
                      "deprecation" : "deprecation",
                      "title" : "title"
                    },
                    "self" : {
                      "hreflang" : "hreflang",
                      "templated" : true,
                      "profile" : "profile",
                      "name" : "name",
                      "href" : "https://api.thousandeyes.com/v7/link/to/resource/id",
                      "type" : "type",
                      "deprecation" : "deprecation",
                      "title" : "title"
                    }
                  },
                  "isDefaultForAccount" : false,
                  "isDefaultForUser" : true,
                  "description" : "HTTP Server Widgets",
                  "isPrivate" : true,
                  "title" : "HTTP Server Widgets",
                  "isBuiltIn" : true,
                  "widgets" : [ {
                    "embedUrl" : "https://embed.thousandeyes.com/e/00aa:3039802d-5c76-42d2-9a93-c6e5f9d3122f",
                    "shouldExcludeAlertSuppressionWindows" : true,
                    "_links" : {
                      "self" : {
                        "hreflang" : "hreflang",
                        "templated" : true,
                        "profile" : "profile",
                        "name" : "name",
                        "href" : "https://api.thousandeyes.com/v7/link/to/resource/id",
                        "type" : "type",
                        "deprecation" : "deprecation",
                        "title" : "title"
                      }
                    },
                    "visualMode" : "Full",
                    "filters" : {
                      "TEST" : [ 5187, 5227 ],
                      "ENDPOINT_MACHINE_ID" : [ "fbd0050c-07f7-43f7-9631-14b32f096962" ]
                    },
                    "title" : "Widget Title",
                    "type" : "Agent Status",
                    "metricGroup" : "BGP",
                    "measure" : {
                      "percentileValue" : 95.0,
                      "type" : "MEAN"
                    },
                    "apiLink" : "apiLink",
                    "metric" : "ENDPOINT_GATEWAY_CPU_LOAD_PERCENT",
                    "isEmbedded" : true,
                    "id" : "1234",
                    "fixedTimespan" : {
                      "unit" : "Days",
                      "value" : 10
                    },
                    "dataSource" : "ENDPOINT_AGENTS",
                    "direction" : "FROM_TARGET"
                  }, {
                    "embedUrl" : "https://embed.thousandeyes.com/e/00aa:3039802d-5c76-42d2-9a93-c6e5f9d3122f",
                    "shouldExcludeAlertSuppressionWindows" : true,
                    "_links" : {
                      "self" : {
                        "hreflang" : "hreflang",
                        "templated" : true,
                        "profile" : "profile",
                        "name" : "name",
                        "href" : "https://api.thousandeyes.com/v7/link/to/resource/id",
                        "type" : "type",
                        "deprecation" : "deprecation",
                        "title" : "title"
                      }
                    },
                    "visualMode" : "Full",
                    "filters" : {
                      "TEST" : [ 5187, 5227 ],
                      "ENDPOINT_MACHINE_ID" : [ "fbd0050c-07f7-43f7-9631-14b32f096962" ]
                    },
                    "title" : "Widget Title",
                    "type" : "Agent Status",
                    "metricGroup" : "BGP",
                    "measure" : {
                      "percentileValue" : 95.0,
                      "type" : "MEAN"
                    },
                    "apiLink" : "apiLink",
                    "metric" : "ENDPOINT_GATEWAY_CPU_LOAD_PERCENT",
                    "isEmbedded" : true,
                    "id" : "1234",
                    "fixedTimespan" : {
                      "unit" : "Days",
                      "value" : 10
                    },
                    "dataSource" : "ENDPOINT_AGENTS",
                    "direction" : "FROM_TARGET"
                  } ],
                  "defaultTimespan" : {
                    "duration" : 7200,
                    "timespanDuration" : 7200,
                    "start" : "2023-05-16T10:14:28Z",
                    "end" : "2023-05-16T11:14:28Z",
                    "timespanStart" : "2023-05-16 10:14:28",
                    "timespanEnd" : "2023-05-16 11:14:28"
                  },
                  "globalFilterId" : "65babd9bb90bf55b17c96c8d",
                  "dashboardId" : "5e1f7a99143ae6004fdc3bb4",
                  "createdBy" : "1",
                  "modifiedDate" : "2023-05-16T10:14:28Z",
                  "modifiedBy" : "1",
                  "isGlobalOverride" : true,
                  "aid" : "1234"
                }
                                  """;
        var statusCode = 200;
        var responseContentType = "application/json";
        Dashboard mappedResponse = 
                mapper.readValue(responseBodyJson, Dashboard.class);
        assertNotNull(mappedResponse);

        var path = "/dashboards/{dashboardId}";
        stubFor(put(urlPathTemplate(path))
                        .withPathParam("dashboardId", equalTo(URLEncoder.encode(dashboardId, StandardCharsets.UTF_8)))
                        .withHeader(AUTHORIZATION, equalTo(BEARER_TOKEN))
                        .withHeader(CONTENT_TYPE, equalTo(requestBodyContentType))
                        .withRequestBody(equalToJson(requestBodyJson))
                        .willReturn(aResponse()
                                            .withHeader(CONTENT_TYPE, responseContentType)
                                            .withBody(responseBodyJson)
                                            .withStatus(statusCode)));

        var apiResponse = api.updateDashboard(dashboardId, mappedRequest, null);
        assertEquals(mappedResponse, apiResponse);
    }
    
}
